<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.40">

  <meta name="author" content="Fernando Cervantes (fernando.cervantes@jax.org)">
  <title>Advanced Machine Learning with Python workshop â€“ Advanced Machine Learning with Python (Session 2)</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-367017fa2871343a8466c6f0f2630bc9.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
  <script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-jnSuA4Ss2PkkikSOLtYs8BlYIeeIK1h99ty4YfvRPAlzr377vr3CXDb7sb7eEEBYjDtcYj+AjBH3FLv5uSJuXg==" crossorigin="anonymous">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Advanced Machine Learning with Python (Session 2)</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Fernando Cervantes (fernando.cervantes@jax.org) 
</div>
</div>
</div>

</section>
<section>
<section id="install-packages" class="title-slide slide level1 center">
<h1>Install packages</h1>
<div id="32770a07" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="op">!</span>pip install s3fs imagecodecs umap<span class="op">-</span>learn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 293, in run
    logger.verbose("Using %s", get_pip_version())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/_log.py", line 23, in verbose
    return self.log(VERBOSE, msg, *args, **kwargs)
Message: 'Using %s'
Arguments: ('pip 24.1.2 from /usr/local/lib/python3.12/dist-packages/pip (python 3.12)',)
Defaulting to user installation because normal site-packages is not writeable
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 294, in run
    options.use_user_site = decide_user_install(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 716, in decide_user_install
    logger.info(
Message: 'Defaulting to user installation because normal site-packages is not writeable'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 333, in run
    build_tracker = self.enter_context(get_build_tracker())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/command_context.py", line 27, in enter_context
    return self._main_context.enter_context(context_provider)
  File "/usr/lib/python3.12/contextlib.py", line 526, in enter_context
    result = _enter(cm)
  File "/usr/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/build/build_tracker.py", line 45, in get_build_tracker
    root = ctx.enter_context(TempDirectory(kind="build-tracker")).path
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/temp_dir.py", line 137, in __init__
    path = self._create(kind)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/temp_dir.py", line 178, in _create
    logger.debug("Created temporary directory: %s", path)
Message: 'Created temporary directory: %s'
Arguments: ('/tmp/pip-build-tracker-ihu6eb30',)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 333, in run
    build_tracker = self.enter_context(get_build_tracker())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/command_context.py", line 27, in enter_context
    return self._main_context.enter_context(context_provider)
  File "/usr/lib/python3.12/contextlib.py", line 526, in enter_context
    result = _enter(cm)
  File "/usr/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/build/build_tracker.py", line 47, in get_build_tracker
    logger.debug("Initialized build tracking at %s", root)
Message: 'Initialized build tracking at %s'
Arguments: ('/tmp/pip-build-tracker-ihu6eb30',)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 333, in run
    build_tracker = self.enter_context(get_build_tracker())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/command_context.py", line 27, in enter_context
    return self._main_context.enter_context(context_provider)
  File "/usr/lib/python3.12/contextlib.py", line 526, in enter_context
    result = _enter(cm)
  File "/usr/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/build/build_tracker.py", line 49, in get_build_tracker
    with BuildTracker(root) as tracker:
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/build/build_tracker.py", line 69, in __init__
    logger.debug("Created build tracker: %s", self._root)
Message: 'Created build tracker: %s'
Arguments: ('/tmp/pip-build-tracker-ihu6eb30',)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 333, in run
    build_tracker = self.enter_context(get_build_tracker())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/command_context.py", line 27, in enter_context
    return self._main_context.enter_context(context_provider)
  File "/usr/lib/python3.12/contextlib.py", line 526, in enter_context
    result = _enter(cm)
  File "/usr/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/build/build_tracker.py", line 49, in get_build_tracker
    with BuildTracker(root) as tracker:
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/build/build_tracker.py", line 72, in __enter__
    logger.debug("Entered build tracker: %s", self._root)
Message: 'Entered build tracker: %s'
Arguments: ('/tmp/pip-build-tracker-ihu6eb30',)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 335, in run
    directory = TempDirectory(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/temp_dir.py", line 137, in __init__
    path = self._create(kind)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/temp_dir.py", line 178, in _create
    logger.debug("Created temporary directory: %s", path)
Message: 'Created temporary directory: %s'
Arguments: ('/tmp/pip-install-sl_p852w',)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 345, in run
    wheel_cache = WheelCache(options.cache_dir)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cache.py", line 218, in __init__
    self._ephem_cache = EphemWheelCache()
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cache.py", line 176, in __init__
    self._temp_dir = TempDirectory(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/temp_dir.py", line 137, in __init__
    path = self._create(kind)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/temp_dir.py", line 178, in _create
    logger.debug("Created temporary directory: %s", path)
Message: 'Created temporary directory: %s'
Arguments: ('/tmp/pip-ephem-wheel-cache-gymkrqej',)
Requirement already satisfied: s3fs in /home/cervaf/.local/lib/python3.12/site-packages (2025.10.0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 's3fs'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 397, in resolve
    self._add_to_criteria(self.state.criteria, r, parent=None)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: s3fs in /home/cervaf/.local/lib/python3.12/site-packages editable=False&gt;, &lt;Version('2025.10.0')&gt;)
Requirement already satisfied: imagecodecs in /home/cervaf/.local/lib/python3.12/site-packages (2025.11.11)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'imagecodecs'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 397, in resolve
    self._add_to_criteria(self.state.criteria, r, parent=None)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: imagecodecs in /home/cervaf/.local/lib/python3.12/site-packages editable=False&gt;, &lt;Version('2025.11.11')&gt;)
Requirement already satisfied: umap-learn in /usr/local/lib/python3.12/dist-packages (0.5.9.post2)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'umap-learn'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 397, in resolve
    self._add_to_criteria(self.state.criteria, r, parent=None)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: umap-learn in /usr/local/lib/python3.12/dist-packages editable=False&gt;, &lt;Version('0.5.9.post2')&gt;)
Requirement already satisfied: aiobotocore&lt;3.0.0,&gt;=2.5.4 in /home/cervaf/.local/lib/python3.12/site-packages (from s3fs) (2.25.2)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'aiobotocore'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: aiobotocore&lt;3.0.0,&gt;=2.5.4 in /home/cervaf/.local/lib/python3.12/site-packages (from s3fs) editable=False&gt;, &lt;Version('2.25.2')&gt;)
Requirement already satisfied: fsspec==2025.10.0 in /home/cervaf/.local/lib/python3.12/site-packages (from s3fs) (2025.10.0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'fsspec'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: fsspec==2025.10.0 in /home/cervaf/.local/lib/python3.12/site-packages (from s3fs) editable=False&gt;, &lt;Version('2025.10.0')&gt;)
Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in /usr/local/lib/python3.12/dist-packages (from s3fs) (3.13.1)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'aiohttp'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: aiohttp!=4.0.0a0,!=4.0.0a1 in /usr/local/lib/python3.12/dist-packages (from s3fs) editable=False&gt;, &lt;Version('3.13.1')&gt;)
Requirement already satisfied: numpy in /usr/local/lib/python3.12/dist-packages (from imagecodecs) (2.0.2)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'numpy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: numpy in /usr/local/lib/python3.12/dist-packages (from imagecodecs) editable=False&gt;, &lt;Version('2.0.2')&gt;)
Requirement already satisfied: scipy&gt;=1.3.1 in /usr/local/lib/python3.12/dist-packages (from umap-learn) (1.16.2)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'scipy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: scipy&gt;=1.3.1 in /usr/local/lib/python3.12/dist-packages (from umap-learn) editable=False&gt;, &lt;Version('1.16.2')&gt;)
Requirement already satisfied: scikit-learn&gt;=1.6 in /usr/local/lib/python3.12/dist-packages (from umap-learn) (1.6.1)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'scikit-learn'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: scikit-learn&gt;=1.6 in /usr/local/lib/python3.12/dist-packages (from umap-learn) editable=False&gt;, &lt;Version('1.6.1')&gt;)
Requirement already satisfied: numba&gt;=0.51.2 in /usr/local/lib/python3.12/dist-packages (from umap-learn) (0.60.0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'numba'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: numba&gt;=0.51.2 in /usr/local/lib/python3.12/dist-packages (from umap-learn) editable=False&gt;, &lt;Version('0.60.0')&gt;)
Requirement already satisfied: pynndescent&gt;=0.5 in /usr/local/lib/python3.12/dist-packages (from umap-learn) (0.5.13)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'pynndescent'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: pynndescent&gt;=0.5 in /usr/local/lib/python3.12/dist-packages (from umap-learn) editable=False&gt;, &lt;Version('0.5.13')&gt;)
Requirement already satisfied: tqdm in /usr/local/lib/python3.12/dist-packages (from umap-learn) (4.67.1)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'tqdm'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: tqdm in /usr/local/lib/python3.12/dist-packages (from umap-learn) editable=False&gt;, &lt;Version('4.67.1')&gt;)
Requirement already satisfied: aioitertools&lt;1.0.0,&gt;=0.5.1 in /home/cervaf/.local/lib/python3.12/site-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) (0.13.0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'aioitertools'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: aioitertools&lt;1.0.0,&gt;=0.5.1 in /home/cervaf/.local/lib/python3.12/site-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) editable=False&gt;, &lt;Version('0.13.0')&gt;)
Requirement already satisfied: botocore&lt;1.40.71,&gt;=1.40.46 in /home/cervaf/.local/lib/python3.12/site-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) (1.40.70)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'botocore'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: botocore&lt;1.40.71,&gt;=1.40.46 in /home/cervaf/.local/lib/python3.12/site-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) editable=False&gt;, &lt;Version('1.40.70')&gt;)
Requirement already satisfied: python-dateutil&lt;3.0.0,&gt;=2.1 in /usr/local/lib/python3.12/dist-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) (2.9.0.post0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'python-dateutil'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: python-dateutil&lt;3.0.0,&gt;=2.1 in /usr/local/lib/python3.12/dist-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) editable=False&gt;, &lt;Version('2.9.0.post0')&gt;)
Requirement already satisfied: jmespath&lt;2.0.0,&gt;=0.7.1 in /home/cervaf/.local/lib/python3.12/site-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) (1.0.1)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'jmespath'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: jmespath&lt;2.0.0,&gt;=0.7.1 in /home/cervaf/.local/lib/python3.12/site-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) editable=False&gt;, &lt;Version('1.0.1')&gt;)
Requirement already satisfied: multidict&lt;7.0.0,&gt;=6.0.0 in /usr/local/lib/python3.12/dist-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) (6.7.0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'multidict'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: multidict&lt;7.0.0,&gt;=6.0.0 in /usr/local/lib/python3.12/dist-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) editable=False&gt;, &lt;Version('6.7.0')&gt;)
Requirement already satisfied: wrapt&lt;2.0.0,&gt;=1.10.10 in /home/cervaf/.local/lib/python3.12/site-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) (1.17.3)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'wrapt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: wrapt&lt;2.0.0,&gt;=1.10.10 in /home/cervaf/.local/lib/python3.12/site-packages (from aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) editable=False&gt;, &lt;Version('1.17.3')&gt;)
Requirement already satisfied: aiohappyeyeballs&gt;=2.5.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) (2.6.1)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'aiohappyeyeballs'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: aiohappyeyeballs&gt;=2.5.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) editable=False&gt;, &lt;Version('2.6.1')&gt;)
Requirement already satisfied: aiosignal&gt;=1.4.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) (1.4.0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'aiosignal'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: aiosignal&gt;=1.4.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) editable=False&gt;, &lt;Version('1.4.0')&gt;)
Requirement already satisfied: attrs&gt;=17.3.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) (25.4.0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'attrs'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: attrs&gt;=17.3.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) editable=False&gt;, &lt;Version('25.4.0')&gt;)
Requirement already satisfied: frozenlist&gt;=1.1.1 in /usr/local/lib/python3.12/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) (1.8.0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'frozenlist'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: frozenlist&gt;=1.1.1 in /usr/local/lib/python3.12/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) editable=False&gt;, &lt;Version('1.8.0')&gt;)
Requirement already satisfied: propcache&gt;=0.2.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) (0.4.1)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'propcache'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: propcache&gt;=0.2.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) editable=False&gt;, &lt;Version('0.4.1')&gt;)
Requirement already satisfied: yarl&lt;2.0,&gt;=1.17.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) (1.22.0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'yarl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: yarl&lt;2.0,&gt;=1.17.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) editable=False&gt;, &lt;Version('1.22.0')&gt;)
Requirement already satisfied: llvmlite&lt;0.44,&gt;=0.43.0dev0 in /usr/local/lib/python3.12/dist-packages (from numba&gt;=0.51.2-&gt;umap-learn) (0.43.0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'llvmlite'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: llvmlite&lt;0.44,&gt;=0.43.0dev0 in /usr/local/lib/python3.12/dist-packages (from numba&gt;=0.51.2-&gt;umap-learn) editable=False&gt;, &lt;Version('0.43.0')&gt;)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.12/dist-packages (from pynndescent&gt;=0.5-&gt;umap-learn) (1.5.2)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'joblib'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: joblib&gt;=0.11 in /usr/local/lib/python3.12/dist-packages (from pynndescent&gt;=0.5-&gt;umap-learn) editable=False&gt;, &lt;Version('1.5.2')&gt;)
Requirement already satisfied: threadpoolctl&gt;=3.1.0 in /usr/local/lib/python3.12/dist-packages (from scikit-learn&gt;=1.6-&gt;umap-learn) (3.6.0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'threadpoolctl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: threadpoolctl&gt;=3.1.0 in /usr/local/lib/python3.12/dist-packages (from scikit-learn&gt;=1.6-&gt;umap-learn) editable=False&gt;, &lt;Version('3.6.0')&gt;)
Requirement already satisfied: typing-extensions&gt;=4.2 in /usr/local/lib/python3.12/dist-packages (from aiosignal&gt;=1.4.0-&gt;aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) (4.15.0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'typing-extensions'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: typing-extensions&gt;=4.2 in /usr/local/lib/python3.12/dist-packages (from aiosignal&gt;=1.4.0-&gt;aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) editable=False&gt;, &lt;Version('4.15.0')&gt;)
Requirement already satisfied: urllib3!=2.2.0,&lt;3,&gt;=1.25.4 in /usr/local/lib/python3.12/dist-packages (from botocore&lt;1.40.71,&gt;=1.40.46-&gt;aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) (2.5.0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'urllib3'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: urllib3!=2.2.0,&lt;3,&gt;=1.25.4 in /usr/local/lib/python3.12/dist-packages (from botocore&lt;1.40.71,&gt;=1.40.46-&gt;aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) editable=False&gt;, &lt;Version('2.5.0')&gt;)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.12/dist-packages (from python-dateutil&lt;3.0.0,&gt;=2.1-&gt;aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) (1.17.0)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'six'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: six&gt;=1.5 in /usr/local/lib/python3.12/dist-packages (from python-dateutil&lt;3.0.0,&gt;=2.1-&gt;aiobotocore&lt;3.0.0,&gt;=2.5.4-&gt;s3fs) editable=False&gt;, &lt;Version('1.17.0')&gt;)
Requirement already satisfied: idna&gt;=2.0 in /usr/local/lib/python3.12/dist-packages (from yarl&lt;2.0,&gt;=1.17.0-&gt;aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) (3.11)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 169, in _make_candidate_from_dist
    base = self._installed_candidate_cache[dist.canonical_name]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'idna'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 95, in resolve
    result = self._result = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 546, in resolve
    state = resolution.resolve(requirements, max_rounds=max_rounds)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 427, in resolve
    failure_causes = self._attempt_to_pin_criterion(name)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 239, in _attempt_to_pin_criterion
    criteria = self._get_updated_criteria(candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 230, in _get_updated_criteria
    self._add_to_criteria(criteria, requirement, parent=candidate)
  File "/usr/local/lib/python3.12/dist-packages/pip/_vendor/resolvelib/resolvers.py", line 148, in _add_to_criteria
    matches = self._p.find_matches(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/provider.py", line 232, in find_matches
    return self._factory.find_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 450, in find_candidates
    return self._iter_found_candidates(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 341, in _iter_found_candidates
    _get_installed_candidate(),
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 289, in _get_installed_candidate
    candidate = self._make_candidate_from_dist(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/factory.py", line 171, in _make_candidate_from_dist
    base = AlreadyInstalledCandidate(dist, template, factory=self)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/candidates.py", line 361, in __init__
    factory.preparer.prepare_installed_requirement(self._ireq, skip_reason)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 721, in prepare_installed_requirement
    logger.info(
Message: 'Requirement %s: %s (%s)'
Arguments: ('already satisfied', &lt;InstallRequirement object: idna&gt;=2.0 in /usr/local/lib/python3.12/dist-packages (from yarl&lt;2.0,&gt;=1.17.0-&gt;aiohttp!=4.0.0a0,!=4.0.0a1-&gt;s3fs) editable=False&gt;, &lt;Version('3.11')&gt;)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 100, in main
    return self._main(args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 232, in _main
    return run(options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 179, in exc_logging_wrapper
    status = run_func(*args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/commands/install.py", line 377, in run
    requirement_set = resolver.resolve(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/resolution/resolvelib/resolver.py", line 179, in resolve
    self.factory.preparer.prepare_linked_requirements_more(reqs)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 554, in prepare_linked_requirements_more
    self._complete_partial_requirements(
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/prepare.py", line 455, in _complete_partial_requirements
    temp_dir = TempDirectory(kind="unpack", globally_managed=True).path
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/temp_dir.py", line 137, in __init__
    path = self._create(kind)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/temp_dir.py", line 178, in _create
    logger.debug("Created temporary directory: %s", path)
Message: 'Created temporary directory: %s'
Arguments: ('/tmp/pip-unpack-9ngfw58_',)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.12/logging/handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/handlers.py", line 191, in shouldRollover
    self.stream = self._open()
                  ^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/utils/logging.py", line 203, in _open
    return super()._open()
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/pip.log'
Call stack:
  File "/usr/local/bin/pip3", line 10, in &lt;module&gt;
    sys.exit(main())
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/main.py", line 80, in main
    return command.main(cmd_args)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/base_command.py", line 99, in main
    with self.main_context():
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/cli/command_context.py", line 19, in main_context
    with self._main_context:
  File "/usr/lib/python3.12/contextlib.py", line 595, in __exit__
    if cb(*exc_details):
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/build/build_tracker.py", line 49, in get_build_tracker
    with BuildTracker(root) as tracker:
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/build/build_tracker.py", line 81, in __exit__
    self.cleanup()
  File "/usr/local/lib/python3.12/dist-packages/pip/_internal/operations/build/build_tracker.py", line 127, in cleanup
    logger.debug("Removed build tracker: %r", self._root)
Message: 'Removed build tracker: %r'
Arguments: ('/tmp/pip-build-tracker-ihu6eb30',)</code></pre>
</div>
</div>
<div id="fe3a251d" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a><span class="op">!</span>git clone https:<span class="op">//</span>github.com<span class="op">/</span>jump<span class="op">-</span>cellpainting<span class="op">/</span>JUMP<span class="op">-</span>Target</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fatal: destination path 'JUMP-Target' already exists and is not an empty directory.</code></pre>
</div>
</div>
<div id="db1bfe30" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a><span class="op">!</span>git clone https:<span class="op">//</span>github.com<span class="op">/</span>jump<span class="op">-</span>cellpainting<span class="op">/</span>datasets.git</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fatal: destination path 'datasets' already exists and is not an empty directory.</code></pre>
</div>
</div>
</section>
<section id="review-the-metadata-of-the-cpg0016-jump-dataset" class="slide level2 scrollable">
<h2>Review the <code>metadata</code> of the <code>cpg0016-jump</code> dataset</h2>
<ul class="task-list">
<li><label><input type="checkbox">Load the plate-level metadata from the <code>jump-cellpainting/datasets</code> repository</label></li>
</ul>
<div id="5f88ea6c" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6c901e47" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a>jump_plates_metadata <span class="op">=</span> pd.read_csv(<span class="st">"datasets/metadata/plate.csv.gz"</span>)</span>
<span id="cb8-2"><a></a>jump_plates_metadata[<span class="st">"Metadata_PlateType"</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>array(['COMPOUND_EMPTY', 'COMPOUND', 'DMSO', 'TARGET2', 'CRISPR', 'ORF',
       'TARGET1', 'POSCON8'], dtype=object)</code></pre>
</div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Inspect the structure of the database</label></li>
</ul>
<div id="c29b5b4c" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a>jump_plates_metadata.groupby([<span class="st">"Metadata_Source"</span>, <span class="st">"Metadata_Batch"</span>]).describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">

  <div id="df-1b77dde7-4c73-4fab-ba70-f1b57370d91b" class="colab-df-container">
    <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="4" data-quarto-table-cell-role="th" data-halign="left">Metadata_Plate</th>
<th colspan="4" data-quarto-table-cell-role="th" data-halign="left">Metadata_PlateType</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">unique</th>
<th data-quarto-table-cell-role="th">top</th>
<th data-quarto-table-cell-role="th">freq</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">unique</th>
<th data-quarto-table-cell-role="th">top</th>
<th data-quarto-table-cell-role="th">freq</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">Metadata_Source</th>
<th data-quarto-table-cell-role="th">Metadata_Batch</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">source_1</td>
<td data-quarto-table-cell-role="th">Batch1_20221004</td>
<td>9</td>
<td>9</td>
<td>UL000109</td>
<td>1</td>
<td>9</td>
<td>2</td>
<td>COMPOUND</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Batch2_20221006</td>
<td>7</td>
<td>7</td>
<td>UL001647</td>
<td>1</td>
<td>7</td>
<td>1</td>
<td>COMPOUND</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Batch3_20221010</td>
<td>8</td>
<td>8</td>
<td>UL000087</td>
<td>1</td>
<td>8</td>
<td>1</td>
<td>COMPOUND</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Batch4_20221012</td>
<td>8</td>
<td>8</td>
<td>UL000081</td>
<td>1</td>
<td>8</td>
<td>1</td>
<td>COMPOUND</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Batch5_20221030</td>
<td>11</td>
<td>11</td>
<td>UL000561</td>
<td>1</td>
<td>11</td>
<td>2</td>
<td>COMPOUND</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">source_9</td>
<td data-quarto-table-cell-role="th">20210918-Run11</td>
<td>9</td>
<td>9</td>
<td>GR00004367</td>
<td>1</td>
<td>9</td>
<td>2</td>
<td>COMPOUND</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20210918-Run12</td>
<td>8</td>
<td>8</td>
<td>GR00004377</td>
<td>1</td>
<td>8</td>
<td>1</td>
<td>COMPOUND</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20211013-Run14</td>
<td>13</td>
<td>13</td>
<td>GR00003279</td>
<td>1</td>
<td>13</td>
<td>2</td>
<td>COMPOUND</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20211102-Run15</td>
<td>11</td>
<td>11</td>
<td>GR00004391</td>
<td>1</td>
<td>11</td>
<td>2</td>
<td>COMPOUND</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20211103-Run16</td>
<td>17</td>
<td>17</td>
<td>GR00004405</td>
<td>1</td>
<td>17</td>
<td>2</td>
<td>COMPOUND</td>
<td>16</td>
</tr>
</tbody>
</table>

<p>149 rows Ã— 8 columns</p>
</div>
    <div class="colab-df-buttons">
      
  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1b77dde7-4c73-4fab-ba70-f1b57370d91b')" title="Convert this dataframe to an interactive table." style="display:none;">
      
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>
    
  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1b77dde7-4c73-4fab-ba70-f1b57370d91b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1b77dde7-4c73-4fab-ba70-f1b57370d91b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>
  
    </div>
  </div>
  
</div>
</div>
</section>
<section id="subset-the-dataset-to-extract-samples-with-crispr-orf-and-nonedmso-treatments" class="slide level2 scrollable">
<h2>Subset the dataset to extract samples with <em>CRISPR</em>, <em>ORF</em>, and <em>NONE/DMSO</em> treatments</h2>
<ul class="task-list">
<li><label><input type="checkbox">Read the <em>CRISPR</em> plate maps from the <code>JUMP-Target</code> repository</label></li>
</ul>
<div id="483e22e9" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a></a>crispr_wells_metadata <span class="op">=</span> pd.read_csv(<span class="st">"JUMP-Target/JUMP-Target-1_crispr_platemap.tsv"</span>, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Add one column to identify the type of treatment, and other to assign a numeric label (<em>CRISPR</em> = 1)</label></li>
</ul>
<div id="afdb68f4" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a></a>crispr_wells_metadata[<span class="st">"Plate_type"</span>] <span class="op">=</span> <span class="st">"CRISPR"</span></span>
<span id="cb12-2"><a></a>crispr_wells_metadata[<span class="st">"Plate_label"</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb12-3"><a></a>crispr_wells_metadata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

  <div id="df-47255937-ea48-4b1c-ab4c-2678eb348d25" class="colab-df-container">
    <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">well_position</th>
<th data-quarto-table-cell-role="th">broad_sample</th>
<th data-quarto-table-cell-role="th">Plate_type</th>
<th data-quarto-table-cell-role="th">Plate_label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A01</td>
<td>BRDN0001480888</td>
<td>CRISPR</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A02</td>
<td>BRDN0001483495</td>
<td>CRISPR</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>A03</td>
<td>BRDN0001147364</td>
<td>CRISPR</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>A04</td>
<td>BRDN0001490272</td>
<td>CRISPR</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>A05</td>
<td>BRDN0001480510</td>
<td>CRISPR</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">379</td>
<td>P20</td>
<td>BRDN0001145303</td>
<td>CRISPR</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">380</td>
<td>P21</td>
<td>BRDN0001484228</td>
<td>CRISPR</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">381</td>
<td>P22</td>
<td>BRDN0001487618</td>
<td>CRISPR</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">382</td>
<td>P23</td>
<td>BRDN0001487864</td>
<td>CRISPR</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">383</td>
<td>P24</td>
<td>BRDN0000735603</td>
<td>CRISPR</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>384 rows Ã— 4 columns</p>
</div>
    <div class="colab-df-buttons">
      
  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-47255937-ea48-4b1c-ab4c-2678eb348d25')" title="Convert this dataframe to an interactive table." style="display:none;">
      
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>
    
  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-47255937-ea48-4b1c-ab4c-2678eb348d25 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-47255937-ea48-4b1c-ab4c-2678eb348d25');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>
  
    </div>
  </div>
  
</div>
</div>
</section>
<section id="subset-the-dataset-to-extract-samples-with-crispr-orf-and-nonedmso-treatments-1" class="slide level2 scrollable">
<h2>Subset the dataset to extract samples with <em>CRISPR</em>, <em>ORF</em>, and <em>NONE/DMSO</em> treatments</h2>
<ul class="task-list">
<li><label><input type="checkbox">Read the <em>ORF</em> plate maps from the <code>JUMP-Target</code> repository</label></li>
</ul>
<div id="59e199bc" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a></a>orf_wells_metadata <span class="op">=</span> pd.read_csv(<span class="st">"JUMP-Target/JUMP-Target-1_orf_platemap.tsv"</span>, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Add one column to identify the type of treatment, and other to assign a numeric label (<em>ORF</em> = 2)</label></li>
</ul>
<div id="c7a614e1" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a></a>orf_wells_metadata[<span class="st">"Plate_type"</span>] <span class="op">=</span> <span class="st">"ORF"</span></span>
<span id="cb14-2"><a></a>orf_wells_metadata[<span class="st">"Plate_label"</span>] <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb14-3"><a></a>orf_wells_metadata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

  <div id="df-ae4dd41c-a754-4d5a-8f54-ffe96e7e26db" class="colab-df-container">
    <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">well_position</th>
<th data-quarto-table-cell-role="th">broad_sample</th>
<th data-quarto-table-cell-role="th">Plate_type</th>
<th data-quarto-table-cell-role="th">Plate_label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A01</td>
<td>ccsbBroad304_00900</td>
<td>ORF</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A02</td>
<td>ccsbBroad304_07795</td>
<td>ORF</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>A03</td>
<td>ccsbBroad304_02826</td>
<td>ORF</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>A04</td>
<td>ccsbBroad304_01492</td>
<td>ORF</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>A05</td>
<td>ccsbBroad304_00691</td>
<td>ORF</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">379</td>
<td>P20</td>
<td>ccsbBroad304_00277</td>
<td>ORF</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">380</td>
<td>P21</td>
<td>ccsbBroad304_06464</td>
<td>ORF</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">381</td>
<td>P22</td>
<td>ccsbBroad304_00476</td>
<td>ORF</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">382</td>
<td>P23</td>
<td>ccsbBroad304_01649</td>
<td>ORF</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">383</td>
<td>P24</td>
<td>ccsbBroad304_03934</td>
<td>ORF</td>
<td>2</td>
</tr>
</tbody>
</table>

<p>384 rows Ã— 4 columns</p>
</div>
    <div class="colab-df-buttons">
      
  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ae4dd41c-a754-4d5a-8f54-ffe96e7e26db')" title="Convert this dataframe to an interactive table." style="display:none;">
      
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>
    
  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ae4dd41c-a754-4d5a-8f54-ffe96e7e26db button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ae4dd41c-a754-4d5a-8f54-ffe96e7e26db');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>
  
    </div>
  </div>
  
</div>
</div>
</section>
<section class="slide level2">

<ul class="task-list">
<li><label><input type="checkbox">Read the <em>COMPOUND</em> plate maps from the <code>JUMP-Target</code> repository</label></li>
</ul>
<div id="e640498a" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a></a>compound_wells_metadata <span class="op">=</span> pd.read_csv(<span class="st">"JUMP-Target/JUMP-Target-1_compound_platemap.tsv"</span>, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Add one column to identify the type of treatment, and other to assign a numeric label (<em>COMPOUND</em> = 3)</label></li>
</ul>
<div id="e29a39eb" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a></a>compound_wells_metadata[<span class="st">"Plate_type"</span>] <span class="op">=</span> <span class="st">"COMPOUND"</span></span>
<span id="cb16-2"><a></a>compound_wells_metadata[<span class="st">"Plate_label"</span>] <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb16-3"><a></a>compound_wells_metadata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

  <div id="df-83a2fe3c-bc06-4dcc-9137-b928a0faa6ce" class="colab-df-container">
    <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">well_position</th>
<th data-quarto-table-cell-role="th">broad_sample</th>
<th data-quarto-table-cell-role="th">solvent</th>
<th data-quarto-table-cell-role="th">Plate_type</th>
<th data-quarto-table-cell-role="th">Plate_label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A01</td>
<td>BRD-A86665761-001-01-1</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A02</td>
<td>NaN</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>A03</td>
<td>BRD-A22032524-074-09-9</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>A04</td>
<td>BRD-A01078468-001-14-8</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>A05</td>
<td>BRD-K48278478-001-01-2</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">379</td>
<td>P20</td>
<td>BRD-K68982262-001-01-4</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">380</td>
<td>P21</td>
<td>BRD-K24616672-003-20-1</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">381</td>
<td>P22</td>
<td>BRD-A82396632-008-30-8</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">382</td>
<td>P23</td>
<td>BRD-K61250553-003-30-6</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">383</td>
<td>P24</td>
<td>BRD-K70358946-001-17-3</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>3</td>
</tr>
</tbody>
</table>

<p>384 rows Ã— 5 columns</p>
</div>
    <div class="colab-df-buttons">
      
  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-83a2fe3c-bc06-4dcc-9137-b928a0faa6ce')" title="Convert this dataframe to an interactive table." style="display:none;">
      
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>
    
  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-83a2fe3c-bc06-4dcc-9137-b928a0faa6ce button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-83a2fe3c-bc06-4dcc-9137-b928a0faa6ce');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>
  
    </div>
  </div>
  
</div>
</div>
</section>
<section class="slide level2">

<ul class="task-list">
<li><label><input type="checkbox">Concatenate the three tables into a single table</label></li>
</ul>
<div id="d12a0c0e" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a></a>wells_metadata <span class="op">=</span> pd.concat([compound_wells_metadata, orf_wells_metadata, crispr_wells_metadata])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Change the label of the well positions that were not treated with any compound (<em>NONE/DMSO</em> = 0)</label></li>
</ul>
<div id="bbf99bb2" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a></a>wells_metadata.loc[wells_metadata[<span class="st">"broad_sample"</span>].isna(), <span class="st">"Plate_label"</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb18-2"><a></a>wells_metadata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">

  <div id="df-fc1bb256-8386-44f2-8cba-46234640f549" class="colab-df-container">
    <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">well_position</th>
<th data-quarto-table-cell-role="th">broad_sample</th>
<th data-quarto-table-cell-role="th">solvent</th>
<th data-quarto-table-cell-role="th">Plate_type</th>
<th data-quarto-table-cell-role="th">Plate_label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A01</td>
<td>BRD-A86665761-001-01-1</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A02</td>
<td>NaN</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>A03</td>
<td>BRD-A22032524-074-09-9</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>A04</td>
<td>BRD-A01078468-001-14-8</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>A05</td>
<td>BRD-K48278478-001-01-2</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">379</td>
<td>P20</td>
<td>BRDN0001145303</td>
<td>NaN</td>
<td>CRISPR</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">380</td>
<td>P21</td>
<td>BRDN0001484228</td>
<td>NaN</td>
<td>CRISPR</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">381</td>
<td>P22</td>
<td>BRDN0001487618</td>
<td>NaN</td>
<td>CRISPR</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">382</td>
<td>P23</td>
<td>BRDN0001487864</td>
<td>NaN</td>
<td>CRISPR</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">383</td>
<td>P24</td>
<td>BRDN0000735603</td>
<td>NaN</td>
<td>CRISPR</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>1152 rows Ã— 5 columns</p>
</div>
    <div class="colab-df-buttons">
      
  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fc1bb256-8386-44f2-8cba-46234640f549')" title="Convert this dataframe to an interactive table." style="display:none;">
      
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>
    
  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fc1bb256-8386-44f2-8cba-46234640f549 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fc1bb256-8386-44f2-8cba-46234640f549');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>
  
    </div>
  </div>
  
</div>
</div>
</section>
<section id="get-the-url-of-each-assay-plate-from-the-s3-bucket" class="slide level2 scrollable">
<h2>Get the URL of each assay plate from the S3 bucket</h2>
<ul class="task-list">
<li><label><input type="checkbox">List the plates in the <code>cellpainting-gallery/cpg0016-jump</code> bucket</label></li>
</ul>
<div id="e4f48359" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a></a><span class="im">import</span> s3fs</span>
<span id="cb19-2"><a></a></span>
<span id="cb19-3"><a></a>fs <span class="op">=</span> s3fs.S3FileSystem(anon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-4"><a></a></span>
<span id="cb19-5"><a></a>batch_names <span class="op">=</span> {}</span>
<span id="cb19-6"><a></a>plate_paths <span class="op">=</span> {}</span>
<span id="cb19-7"><a></a>source_names <span class="op">=</span> {}</span>
<span id="cb19-8"><a></a>plate_types <span class="op">=</span> {}</span>
<span id="cb19-9"><a></a></span>
<span id="cb19-10"><a></a><span class="cf">for</span> _, src_row <span class="kw">in</span> jump_plates_metadata.groupby([<span class="st">"Metadata_Source"</span>, <span class="st">"Metadata_Batch"</span>]).describe().iterrows():</span>
<span id="cb19-11"><a></a>    source_name, batch_name <span class="op">=</span> src_row.name</span>
<span id="cb19-12"><a></a></span>
<span id="cb19-13"><a></a>    <span class="co"># Ignore 'source_8' since the naming of the images is not standard</span></span>
<span id="cb19-14"><a></a>    <span class="cf">if</span> source_name <span class="kw">in</span> [<span class="st">"source_8"</span>]:</span>
<span id="cb19-15"><a></a>        <span class="cf">continue</span></span>
<span id="cb19-16"><a></a></span>
<span id="cb19-17"><a></a>    plate_type <span class="op">=</span> src_row[<span class="st">"Metadata_PlateType"</span>].top</span>
<span id="cb19-18"><a></a></span>
<span id="cb19-19"><a></a>    <span class="cf">for</span> plate_path <span class="kw">in</span> fs.ls(<span class="ss">f"cellpainting-gallery/cpg0016-jump/</span><span class="sc">{</span>source_name<span class="sc">}</span><span class="ss">/images/</span><span class="sc">{</span>batch_name<span class="sc">}</span><span class="ss">/images/"</span>):</span>
<span id="cb19-20"><a></a>        plate_path <span class="op">=</span> plate_path.split(<span class="st">"/"</span>)[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb19-21"><a></a>        <span class="cf">if</span> <span class="kw">not</span> plate_path:</span>
<span id="cb19-22"><a></a>            <span class="cf">continue</span></span>
<span id="cb19-23"><a></a></span>
<span id="cb19-24"><a></a>        plate_name <span class="op">=</span> plate_path.split(<span class="st">"__"</span>)[<span class="dv">0</span>]</span>
<span id="cb19-25"><a></a></span>
<span id="cb19-26"><a></a>        source_names[plate_name] <span class="op">=</span> source_name</span>
<span id="cb19-27"><a></a>        batch_names[plate_name] <span class="op">=</span> batch_name</span>
<span id="cb19-28"><a></a>        plate_types[plate_name] <span class="op">=</span> plate_type</span>
<span id="cb19-29"><a></a>        plate_paths[plate_name] <span class="op">=</span> plate_path</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="get-the-url-of-each-assay-plate-from-the-s3-bucket-1" class="slide level2 scrollable">
<h2>Get the URL of each assay plate from the S3 bucket</h2>
<ul class="task-list">
<li><label><input type="checkbox">Create a <code>pandas</code> data frame to associate each plate to its location within the S3 bucket</label></li>
</ul>
<div id="ec0cb967" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a></a>plate_maps <span class="op">=</span> pd.DataFrame()</span>
<span id="cb20-2"><a></a></span>
<span id="cb20-3"><a></a>plate_maps[<span class="st">"Plate_name"</span>] <span class="op">=</span> batch_names.keys()</span>
<span id="cb20-4"><a></a>plate_maps[<span class="st">"Source_name"</span>] <span class="op">=</span> plate_maps[<span class="st">"Plate_name"</span>].<span class="bu">map</span>(source_names)</span>
<span id="cb20-5"><a></a>plate_maps[<span class="st">"Batch_name"</span>] <span class="op">=</span> plate_maps[<span class="st">"Plate_name"</span>].<span class="bu">map</span>(batch_names)</span>
<span id="cb20-6"><a></a>plate_maps[<span class="st">"Plate_type"</span>] <span class="op">=</span> plate_maps[<span class="st">"Plate_name"</span>].<span class="bu">map</span>(plate_types)</span>
<span id="cb20-7"><a></a>plate_maps[<span class="st">"Plate_path"</span>] <span class="op">=</span> plate_maps[<span class="st">"Plate_name"</span>].<span class="bu">map</span>(plate_paths)</span>
<span id="cb20-8"><a></a></span>
<span id="cb20-9"><a></a>plate_maps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

  <div id="df-6f37a666-b04f-4233-ac67-5fe2f125be10" class="colab-df-container">
    <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Plate_name</th>
<th data-quarto-table-cell-role="th">Source_name</th>
<th data-quarto-table-cell-role="th">Batch_name</th>
<th data-quarto-table-cell-role="th">Plate_type</th>
<th data-quarto-table-cell-role="th">Plate_path</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>UL000109</td>
<td>source_1</td>
<td>Batch1_20221004</td>
<td>COMPOUND</td>
<td>UL000109__2022-10-05T06_35_06-Measurement1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>UL001641</td>
<td>source_1</td>
<td>Batch1_20221004</td>
<td>COMPOUND</td>
<td>UL001641__2022-10-04T23_16_28-Measurement1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>UL001643</td>
<td>source_1</td>
<td>Batch1_20221004</td>
<td>COMPOUND</td>
<td>UL001643__2022-10-04T18_52_42-Measurement2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>UL001645</td>
<td>source_1</td>
<td>Batch1_20221004</td>
<td>COMPOUND</td>
<td>UL001645__2022-10-05T00_44_11-Measurement1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>UL001651</td>
<td>source_1</td>
<td>Batch1_20221004</td>
<td>COMPOUND</td>
<td>UL001651__2022-10-04T20_20_52-Measurement1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2333</td>
<td>GR00004417</td>
<td>source_9</td>
<td>20211103-Run16</td>
<td>COMPOUND</td>
<td>GR00004417</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2334</td>
<td>GR00004418</td>
<td>source_9</td>
<td>20211103-Run16</td>
<td>COMPOUND</td>
<td>GR00004418</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2335</td>
<td>GR00004419</td>
<td>source_9</td>
<td>20211103-Run16</td>
<td>COMPOUND</td>
<td>GR00004419</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2336</td>
<td>GR00004420</td>
<td>source_9</td>
<td>20211103-Run16</td>
<td>COMPOUND</td>
<td>GR00004420</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2337</td>
<td>GR00004421</td>
<td>source_9</td>
<td>20211103-Run16</td>
<td>COMPOUND</td>
<td>GR00004421</td>
</tr>
</tbody>
</table>

<p>2338 rows Ã— 5 columns</p>
</div>
    <div class="colab-df-buttons">
      
  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-6f37a666-b04f-4233-ac67-5fe2f125be10')" title="Convert this dataframe to an interactive table." style="display:none;">
      
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>
    
  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-6f37a666-b04f-4233-ac67-5fe2f125be10 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-6f37a666-b04f-4233-ac67-5fe2f125be10');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>
  
    </div>
  </div>
  
</div>
</div>
</section>
<section id="subset-the-data-frame-to-separate-perturbation-crisprorfnone-plates-from-compound-plates" class="slide level2 scrollable">
<h2>Subset the data frame to separate perturbation (<em>CRISPR/ORF/NONE</em>) plates from <em>COMPOUND</em> plates</h2>
<ul class="task-list">
<li><label><input type="checkbox">Subset the <em>COMPOUND</em> plates</label></li>
</ul>
<div id="68253176" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a></a>comp_plate_maps <span class="op">=</span> plate_maps.query(<span class="st">"Plate_type=='COMPOUND'"</span>)</span>
<span id="cb21-2"><a></a>comp_plate_maps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

  <div id="df-fe0ff7ef-2a22-4266-8b02-eeeb43b94624" class="colab-df-container">
    <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Plate_name</th>
<th data-quarto-table-cell-role="th">Source_name</th>
<th data-quarto-table-cell-role="th">Batch_name</th>
<th data-quarto-table-cell-role="th">Plate_type</th>
<th data-quarto-table-cell-role="th">Plate_path</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>UL000109</td>
<td>source_1</td>
<td>Batch1_20221004</td>
<td>COMPOUND</td>
<td>UL000109__2022-10-05T06_35_06-Measurement1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>UL001641</td>
<td>source_1</td>
<td>Batch1_20221004</td>
<td>COMPOUND</td>
<td>UL001641__2022-10-04T23_16_28-Measurement1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>UL001643</td>
<td>source_1</td>
<td>Batch1_20221004</td>
<td>COMPOUND</td>
<td>UL001643__2022-10-04T18_52_42-Measurement2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>UL001645</td>
<td>source_1</td>
<td>Batch1_20221004</td>
<td>COMPOUND</td>
<td>UL001645__2022-10-05T00_44_11-Measurement1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>UL001651</td>
<td>source_1</td>
<td>Batch1_20221004</td>
<td>COMPOUND</td>
<td>UL001651__2022-10-04T20_20_52-Measurement1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2333</td>
<td>GR00004417</td>
<td>source_9</td>
<td>20211103-Run16</td>
<td>COMPOUND</td>
<td>GR00004417</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2334</td>
<td>GR00004418</td>
<td>source_9</td>
<td>20211103-Run16</td>
<td>COMPOUND</td>
<td>GR00004418</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2335</td>
<td>GR00004419</td>
<td>source_9</td>
<td>20211103-Run16</td>
<td>COMPOUND</td>
<td>GR00004419</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2336</td>
<td>GR00004420</td>
<td>source_9</td>
<td>20211103-Run16</td>
<td>COMPOUND</td>
<td>GR00004420</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2337</td>
<td>GR00004421</td>
<td>source_9</td>
<td>20211103-Run16</td>
<td>COMPOUND</td>
<td>GR00004421</td>
</tr>
</tbody>
</table>

<p>1905 rows Ã— 5 columns</p>
</div>
    <div class="colab-df-buttons">
      
  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fe0ff7ef-2a22-4266-8b02-eeeb43b94624')" title="Convert this dataframe to an interactive table." style="display:none;">
      
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>
    
  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fe0ff7ef-2a22-4266-8b02-eeeb43b94624 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fe0ff7ef-2a22-4266-8b02-eeeb43b94624');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>
  
    </div>
  </div>
  
</div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Subset the <em>CRISPR/ORF/DMSO</em> plates</label></li>
</ul>
<div id="4b7015f5" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a></a>pert_plate_maps <span class="op">=</span> plate_maps[plate_maps[<span class="st">"Plate_type"</span>].isin([<span class="st">"CRISPR"</span>, <span class="st">"ORF"</span>, <span class="st">"DMSO"</span>])]</span>
<span id="cb22-2"><a></a>pert_plate_maps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">

  <div id="df-bd24362c-6c37-4ea9-a936-9c5591cf0161" class="colab-df-container">
    <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Plate_name</th>
<th data-quarto-table-cell-role="th">Source_name</th>
<th data-quarto-table-cell-role="th">Batch_name</th>
<th data-quarto-table-cell-role="th">Plate_type</th>
<th data-quarto-table-cell-role="th">Plate_path</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">142</td>
<td>Dest210628-161651</td>
<td>source_10</td>
<td>2021_06_28_U2OS_48_hr_run9</td>
<td>DMSO</td>
<td>Dest210628-161651</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">143</td>
<td>Dest210628-162003</td>
<td>source_10</td>
<td>2021_06_28_U2OS_48_hr_run9</td>
<td>DMSO</td>
<td>Dest210628-162003</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">457</td>
<td>CP-CC9-R1-01</td>
<td>source_13</td>
<td>20220914_Run1</td>
<td>CRISPR</td>
<td>CP-CC9-R1-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">458</td>
<td>CP-CC9-R1-02</td>
<td>source_13</td>
<td>20220914_Run1</td>
<td>CRISPR</td>
<td>CP-CC9-R1-02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">459</td>
<td>CP-CC9-R1-03</td>
<td>source_13</td>
<td>20220914_Run1</td>
<td>CRISPR</td>
<td>CP-CC9-R1-03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1591</td>
<td>BR00127145</td>
<td>source_4</td>
<td>2021_08_30_Batch13</td>
<td>ORF</td>
<td>BR00127145__2021-09-22T04_01_46-Measurement1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1592</td>
<td>BR00127146</td>
<td>source_4</td>
<td>2021_08_30_Batch13</td>
<td>ORF</td>
<td>BR00127146__2021-09-22T12_25_07-Measurement1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1593</td>
<td>BR00127147</td>
<td>source_4</td>
<td>2021_08_30_Batch13</td>
<td>ORF</td>
<td>BR00127147__2021-09-18T10_27_12-Measurement1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1594</td>
<td>BR00127148</td>
<td>source_4</td>
<td>2021_08_30_Batch13</td>
<td>ORF</td>
<td>BR00127148__2021-09-21T11_44_23-Measurement1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1595</td>
<td>BR00127149</td>
<td>source_4</td>
<td>2021_08_30_Batch13</td>
<td>ORF</td>
<td>BR00127149__2021-09-18T02_10_04-Measurement1</td>
</tr>
</tbody>
</table>

<p>433 rows Ã— 5 columns</p>
</div>
    <div class="colab-df-buttons">
      
  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bd24362c-6c37-4ea9-a936-9c5591cf0161')" title="Convert this dataframe to an interactive table." style="display:none;">
      
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>
    
  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bd24362c-6c37-4ea9-a936-9c5591cf0161 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bd24362c-6c37-4ea9-a936-9c5591cf0161');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>
  
    </div>
  </div>
  
</div>
</div>
</section></section>
<section>
<section id="create-a-pipeline-for-loading-images-from-the-cellpainting-gallery-storage" class="title-slide slide level1 center">
<h1>Create a pipeline for loading images from the <code>cellpainting-gallery</code> storage</h1>

</section>
<section id="split-the-perturbation-plates-into-training-validation-and-test-sets" class="slide level2 scrollable">
<h2>Split the perturbation plates into Training, Validation, and Test sets</h2>
<p>Weâ€™ll separate the plates in each batch into the three sets to have batch-level effects in each of the sets</p>
<ul class="task-list">
<li><label><input type="checkbox">Assign <span class="math inline">\(70\)</span> % of plates for training, <span class="math inline">\(20\)</span> % for validation, and <span class="math inline">\(10\)</span> % for testing</label></li>
</ul>
<div id="165b8534" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a></a><span class="im">import</span> random</span>
<span id="cb23-2"><a></a><span class="im">import</span> math</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="95ccc746" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a></a>trn_plates <span class="op">=</span> []</span>
<span id="cb24-2"><a></a>val_plates <span class="op">=</span> []</span>
<span id="cb24-3"><a></a>tst_plates <span class="op">=</span> []</span>
<span id="cb24-4"><a></a></span>
<span id="cb24-5"><a></a>trn_proportion <span class="op">=</span> <span class="fl">0.7</span></span>
<span id="cb24-6"><a></a>val_proportion <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb24-7"><a></a>tst_proportion <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb24-8"><a></a></span>
<span id="cb24-9"><a></a><span class="cf">for</span> batch_name <span class="kw">in</span> pert_plate_maps[<span class="st">"Batch_name"</span>].unique():</span>
<span id="cb24-10"><a></a>    plate_names <span class="op">=</span> pert_plate_maps.query(<span class="ss">f"Batch_name == '</span><span class="sc">{</span>batch_name<span class="sc">}</span><span class="ss">'"</span>)[<span class="st">"Plate_name"</span>].tolist()</span>
<span id="cb24-11"><a></a>    random.shuffle(plate_names)</span>
<span id="cb24-12"><a></a></span>
<span id="cb24-13"><a></a>    tst_plates_count <span class="op">=</span> <span class="bu">int</span>(math.ceil(<span class="bu">len</span>(plate_names) <span class="op">*</span> tst_proportion))</span>
<span id="cb24-14"><a></a>    val_plates_count <span class="op">=</span> <span class="bu">int</span>(math.ceil(<span class="bu">len</span>(plate_names) <span class="op">*</span> val_proportion))</span>
<span id="cb24-15"><a></a></span>
<span id="cb24-16"><a></a>    tst_plates <span class="op">+=</span> plate_names[:tst_plates_count]</span>
<span id="cb24-17"><a></a>    val_plates <span class="op">+=</span> plate_names[tst_plates_count:tst_plates_count <span class="op">+</span> val_plates_count]</span>
<span id="cb24-18"><a></a>    trn_plates <span class="op">+=</span> plate_names[tst_plates_count <span class="op">+</span> val_plates_count:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="907ab0a6" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a></a><span class="bu">print</span>(<span class="st">"Training set size:"</span>, <span class="bu">len</span>(trn_plates))</span>
<span id="cb25-2"><a></a><span class="bu">print</span>(<span class="st">"Validation set size:"</span>, <span class="bu">len</span>(val_plates))</span>
<span id="cb25-3"><a></a><span class="bu">print</span>(<span class="st">"Testing set size:"</span>, <span class="bu">len</span>(tst_plates))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training set size: 283
Validation set size: 96
Testing set size: 54</code></pre>
</div>
</div>
</section>
<section id="create-a-pytorch-dataset-to-load-images-from-s3-storage" class="slide level2 scrollable">
<h2>Create a PyTorch Dataset to load images from S3 storage</h2>
<p>Defining a custom PyTorch dataset allows us to access the image data from S3 storage, even if it is not in a standard format across the distinct sources inside the database. Moreover, it is completely iterative, so no additional storage is used as the images are analyzed <em>on the fly</em>.</p>
<div id="2b861bbb" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a></a><span class="co"># @title Definition of a Dataset class capable to pull images from S3 buckets</span></span>
<span id="cb27-2"><a></a><span class="im">import</span> random</span>
<span id="cb27-3"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb27-4"><a></a><span class="im">import</span> string</span>
<span id="cb27-5"><a></a><span class="im">import</span> s3fs</span>
<span id="cb27-6"><a></a></span>
<span id="cb27-7"><a></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb27-8"><a></a></span>
<span id="cb27-9"><a></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb27-10"><a></a><span class="im">import</span> tifffile</span>
<span id="cb27-11"><a></a></span>
<span id="cb27-12"><a></a><span class="im">from</span> torch.utils.data <span class="im">import</span> IterableDataset, get_worker_info</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Define a function to load an image from the <code>cellpainting-gallery</code> bucket given a <em>field-well</em> position from a specific <em>plate</em></label></li>
</ul>
<div id="f7b5e77e" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a></a><span class="kw">def</span> load_well(plate_metadata, well_row, well_col, field_id, channels, s3):</span>
<span id="cb28-2"><a></a>    <span class="co"># Get the label of the current well</span></span>
<span id="cb28-3"><a></a>    curr_well_image <span class="op">=</span> []</span>
<span id="cb28-4"><a></a></span>
<span id="cb28-5"><a></a>    plate_path <span class="op">=</span> <span class="st">"cellpainting-gallery/cpg0016-jump/"</span> <span class="op">+</span> plate_metadata[<span class="st">"Source_name"</span>] <span class="op">+</span> <span class="st">"/images/"</span> <span class="op">+</span> plate_metadata[<span class="st">"Batch_name"</span>] <span class="op">+</span> <span class="st">"/images/"</span> <span class="op">+</span> plate_metadata[<span class="st">"Plate_path"</span>]</span>
<span id="cb28-6"><a></a></span>
<span id="cb28-7"><a></a>    <span class="cf">for</span> channel_id <span class="kw">in</span> <span class="bu">range</span>(channels):</span>
<span id="cb28-8"><a></a>        <span class="cf">if</span> plate_metadata[<span class="st">"Source_name"</span>] <span class="kw">in</span> [<span class="st">"source_1"</span>, <span class="st">"source_3"</span>, <span class="st">"source_4"</span>, <span class="st">"source_9"</span>, <span class="st">"source_11"</span>, <span class="st">"source_15"</span>]:</span>
<span id="cb28-9"><a></a>            image_suffix <span class="op">=</span> <span class="ss">f"Images/r</span><span class="sc">{</span>well_row <span class="op">+</span> <span class="dv">1</span><span class="sc">:02d}</span><span class="ss">c</span><span class="sc">{</span>well_col <span class="op">+</span> <span class="dv">1</span><span class="sc">:02d}</span><span class="ss">f</span><span class="sc">{</span>field_id <span class="op">+</span> <span class="dv">1</span><span class="sc">:02d}</span><span class="ss">p01-ch</span><span class="sc">{</span>channel_id <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">sk1fk1fl1.tiff"</span></span>
<span id="cb28-10"><a></a></span>
<span id="cb28-11"><a></a>        <span class="cf">else</span>:</span>
<span id="cb28-12"><a></a>            <span class="cf">if</span> plate_metadata[<span class="st">"Source_name"</span>] <span class="kw">in</span> [<span class="st">"source_2"</span>, <span class="st">"source_5"</span>]:</span>
<span id="cb28-13"><a></a>                a_locs <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb28-14"><a></a>            <span class="cf">elif</span> plate_metadata[<span class="st">"Source_name"</span>] <span class="kw">in</span> [<span class="st">"source_6"</span>, <span class="st">"source_10"</span>]:</span>
<span id="cb28-15"><a></a>                a_locs <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>]</span>
<span id="cb28-16"><a></a>            <span class="cf">elif</span> plate_metadata[<span class="st">"Source_name"</span>] <span class="kw">in</span> [<span class="st">"source_7"</span>, <span class="st">"source_13"</span>]:</span>
<span id="cb28-17"><a></a>                a_locs <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb28-18"><a></a></span>
<span id="cb28-19"><a></a>            image_suffix <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>plate_metadata[<span class="st">"Plate_name"</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>string<span class="sc">.</span>ascii_uppercase[well_row]<span class="sc">}{</span>well_col <span class="op">+</span> <span class="dv">1</span><span class="sc">:02d}</span><span class="ss">_T0001F</span><span class="sc">{</span>field_id <span class="op">+</span> <span class="dv">1</span><span class="sc">:03d}</span><span class="ss">L01A</span><span class="sc">{</span>a_locs[channel_id]<span class="sc">:02d}</span><span class="ss">Z01C</span><span class="sc">{</span>channel_id <span class="op">+</span> <span class="dv">1</span><span class="sc">:02d}</span><span class="ss">.tif"</span></span>
<span id="cb28-20"><a></a></span>
<span id="cb28-21"><a></a>        image_url <span class="op">=</span> <span class="st">"s3://"</span> <span class="op">+</span> plate_path <span class="op">+</span> <span class="st">"/"</span> <span class="op">+</span> image_suffix</span>
<span id="cb28-22"><a></a></span>
<span id="cb28-23"><a></a>        <span class="cf">try</span>:</span>
<span id="cb28-24"><a></a>            <span class="cf">with</span> s3.<span class="bu">open</span>(image_url, <span class="st">'rb'</span>) <span class="im">as</span> f:</span>
<span id="cb28-25"><a></a>                curr_image <span class="op">=</span> tifffile.imread(f)</span>
<span id="cb28-26"><a></a></span>
<span id="cb28-27"><a></a>        <span class="cf">except</span> <span class="pp">FileNotFoundError</span>:</span>
<span id="cb28-28"><a></a>            <span class="bu">print</span>(<span class="st">"Failed retrieving:"</span>, image_url)</span>
<span id="cb28-29"><a></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb28-30"><a></a></span>
<span id="cb28-31"><a></a>        curr_image <span class="op">=</span> curr_image.astype(np.float32)</span>
<span id="cb28-32"><a></a>        curr_image <span class="op">/=</span> <span class="dv">2</span> <span class="op">**</span> <span class="dv">16</span> <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb28-33"><a></a></span>
<span id="cb28-34"><a></a>        curr_well_image.append(curr_image)</span>
<span id="cb28-35"><a></a></span>
<span id="cb28-36"><a></a>    curr_well_image <span class="op">=</span> np.array(curr_well_image)</span>
<span id="cb28-37"><a></a></span>
<span id="cb28-38"><a></a>    <span class="cf">return</span> curr_well_image</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-a-pytorch-dataset-to-load-images-from-s3-storage-1" class="slide level2 scrollable">
<h2>Create a PyTorch Dataset to load images from S3 storage</h2>
<ul class="task-list">
<li><label><input type="checkbox">Define an <code>IterableDataset</code> derived class to load images from S3 storage</label></li>
</ul>
<div id="d1599d5a" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a></a><span class="kw">class</span> TiffS3Dataset(IterableDataset):</span>
<span id="cb29-2"><a></a>    <span class="co">"""This dataset could have virtually infinite samples.</span></span>
<span id="cb29-3"><a></a><span class="co">    """</span></span>
<span id="cb29-4"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, plate_maps, wells_metadata, plate_names, well_rows<span class="op">=</span><span class="dv">24</span>, well_cols<span class="op">=</span><span class="dv">16</span>, fields<span class="op">=</span><span class="dv">4</span>, channels<span class="op">=</span><span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb29-5"><a></a>        <span class="bu">super</span>(TiffS3Dataset).<span class="fu">__init__</span>()</span>
<span id="cb29-6"><a></a></span>
<span id="cb29-7"><a></a>        <span class="va">self</span>._plate_maps <span class="op">=</span> plate_maps</span>
<span id="cb29-8"><a></a>        <span class="va">self</span>._wells_metadata <span class="op">=</span> wells_metadata</span>
<span id="cb29-9"><a></a></span>
<span id="cb29-10"><a></a>        <span class="va">self</span>._plate_names <span class="op">=</span> plate_names</span>
<span id="cb29-11"><a></a>        <span class="va">self</span>._well_rows <span class="op">=</span> well_rows</span>
<span id="cb29-12"><a></a>        <span class="va">self</span>._well_cols <span class="op">=</span> well_cols</span>
<span id="cb29-13"><a></a>        <span class="va">self</span>._fields <span class="op">=</span> fields</span>
<span id="cb29-14"><a></a>        <span class="va">self</span>._channels <span class="op">=</span> channels</span>
<span id="cb29-15"><a></a></span>
<span id="cb29-16"><a></a>        <span class="va">self</span>._shuffle <span class="op">=</span> shuffle</span>
<span id="cb29-17"><a></a></span>
<span id="cb29-18"><a></a>        <span class="va">self</span>._worker_sel <span class="op">=</span> <span class="bu">slice</span>(<span class="dv">0</span>, <span class="bu">len</span>(plate_names) <span class="op">*</span> <span class="va">self</span>._well_rows <span class="op">*</span> <span class="va">self</span>._well_cols)</span>
<span id="cb29-19"><a></a>        <span class="va">self</span>._worker_id <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb29-20"><a></a>        <span class="va">self</span>._num_workers <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb29-21"><a></a></span>
<span id="cb29-22"><a></a>        <span class="va">self</span>._s3 <span class="op">=</span> <span class="va">None</span></span>
<span id="cb29-23"><a></a></span>
<span id="cb29-24"><a></a>    <span class="kw">def</span> <span class="fu">__iter__</span>(<span class="va">self</span>):</span>
<span id="cb29-25"><a></a>        <span class="co"># Select the barcodes that correspond to this worker</span></span>
<span id="cb29-26"><a></a>        <span class="va">self</span>._s3 <span class="op">=</span> s3fs.S3FileSystem(anon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-27"><a></a></span>
<span id="cb29-28"><a></a>        <span class="va">self</span>._plate_names <span class="op">=</span> <span class="va">self</span>._plate_names[<span class="va">self</span>._worker_sel]</span>
<span id="cb29-29"><a></a></span>
<span id="cb29-30"><a></a>        well_row_range <span class="op">=</span> <span class="bu">range</span>(<span class="va">self</span>._well_rows)</span>
<span id="cb29-31"><a></a>        well_col_range <span class="op">=</span> <span class="bu">range</span>(<span class="va">self</span>._well_cols)</span>
<span id="cb29-32"><a></a>        fields_range <span class="op">=</span> <span class="bu">range</span>(<span class="va">self</span>._fields)</span>
<span id="cb29-33"><a></a></span>
<span id="cb29-34"><a></a>        <span class="cf">for</span> plate_name, well_row, well_col, field_id <span class="kw">in</span> product(<span class="va">self</span>._plate_names, well_row_range, well_col_range, fields_range):</span>
<span id="cb29-35"><a></a>            <span class="cf">if</span> <span class="va">self</span>._shuffle:</span>
<span id="cb29-36"><a></a>                plate_name <span class="op">=</span> random.choice(<span class="va">self</span>._plate_names)</span>
<span id="cb29-37"><a></a>                well_row <span class="op">=</span> random.randrange(<span class="va">self</span>._well_rows)</span>
<span id="cb29-38"><a></a>                well_col <span class="op">=</span> random.randrange(<span class="va">self</span>._well_cols)</span>
<span id="cb29-39"><a></a>                field_id <span class="op">=</span> random.randrange(<span class="va">self</span>._fields)</span>
<span id="cb29-40"><a></a></span>
<span id="cb29-41"><a></a>            curr_plate_map <span class="op">=</span> <span class="va">self</span>._plate_maps.query(<span class="ss">f"Plate_name == '</span><span class="sc">{</span>plate_name<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb29-42"><a></a></span>
<span id="cb29-43"><a></a>            curr_plate_metadata <span class="op">=</span> curr_plate_map.to_dict(orient<span class="op">=</span><span class="st">'records'</span>)[<span class="dv">0</span>]</span>
<span id="cb29-44"><a></a></span>
<span id="cb29-45"><a></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">len</span>(curr_plate_metadata):</span>
<span id="cb29-46"><a></a>                <span class="cf">continue</span></span>
<span id="cb29-47"><a></a></span>
<span id="cb29-48"><a></a>            curr_image <span class="op">=</span> load_well(curr_plate_metadata, well_row, well_col, field_id, <span class="va">self</span>._channels, <span class="va">self</span>._s3)</span>
<span id="cb29-49"><a></a></span>
<span id="cb29-50"><a></a>            <span class="cf">if</span> curr_image <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb29-51"><a></a>                <span class="cf">continue</span></span>
<span id="cb29-52"><a></a></span>
<span id="cb29-53"><a></a>            curr_plate_metadata[<span class="st">"Well_position"</span>] <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>string<span class="sc">.</span>ascii_uppercase[well_row]<span class="sc">}{</span>well_col <span class="op">+</span> <span class="dv">1</span><span class="sc">:02d}</span><span class="ss">"</span></span>
<span id="cb29-54"><a></a></span>
<span id="cb29-55"><a></a>            curr_image <span class="op">=</span> curr_image[:, :<span class="dv">1080</span>, :<span class="dv">1080</span>]</span>
<span id="cb29-56"><a></a>            _, h, w <span class="op">=</span> curr_image.shape</span>
<span id="cb29-57"><a></a>            pad_h <span class="op">=</span> <span class="dv">1080</span> <span class="op">-</span> h</span>
<span id="cb29-58"><a></a>            pad_w <span class="op">=</span> <span class="dv">1080</span> <span class="op">-</span> w</span>
<span id="cb29-59"><a></a></span>
<span id="cb29-60"><a></a>            <span class="cf">if</span> pad_h <span class="kw">or</span> pad_w:</span>
<span id="cb29-61"><a></a>                curr_image <span class="op">=</span> np.pad(curr_image, ((<span class="dv">0</span>, <span class="dv">0</span>), (<span class="dv">0</span>, pad_h), (<span class="dv">0</span>, pad_w)))</span>
<span id="cb29-62"><a></a>            </span>
<span id="cb29-63"><a></a>            <span class="cf">if</span> curr_plate_metadata[<span class="st">"Plate_type"</span>] <span class="op">==</span> <span class="st">"DMSO"</span>:</span>
<span id="cb29-64"><a></a>                curr_label <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb29-65"><a></a></span>
<span id="cb29-66"><a></a>            <span class="cf">else</span>:</span>
<span id="cb29-67"><a></a>                curr_label <span class="op">=</span> <span class="va">self</span>._wells_metadata.query(<span class="ss">f"Plate_type=='</span><span class="sc">{</span>curr_plate_metadata[<span class="st">"Plate_type"</span>]<span class="sc">}</span><span class="ss">' &amp; well_position=='</span><span class="sc">{</span>string<span class="sc">.</span>ascii_uppercase[well_row]<span class="sc">}{</span>well_col <span class="op">+</span> <span class="dv">1</span><span class="sc">:02d}</span><span class="ss">'"</span>)[<span class="st">"Plate_label"</span>]</span>
<span id="cb29-68"><a></a></span>
<span id="cb29-69"><a></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">len</span>(curr_label):</span>
<span id="cb29-70"><a></a>                    <span class="cf">continue</span></span>
<span id="cb29-71"><a></a></span>
<span id="cb29-72"><a></a>                curr_label <span class="op">=</span> curr_label.item()</span>
<span id="cb29-73"><a></a></span>
<span id="cb29-74"><a></a>            <span class="cf">yield</span> curr_image, curr_label, curr_plate_metadata</span>
<span id="cb29-75"><a></a></span>
<span id="cb29-76"><a></a>        <span class="va">self</span>._s3 <span class="op">=</span> <span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-a-pytorch-dataset-to-load-images-from-s3-storage-2" class="slide level2 scrollable">
<h2>Create a PyTorch Dataset to load images from S3 storage</h2>
<ul class="task-list">
<li><label><input type="checkbox">Define an initialization function to separate the load when using <em>multi-thread</em> data loading</label></li>
</ul>
<div id="a6881210" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a></a><span class="kw">def</span> dataset_worker_init_fn(worker_id):</span>
<span id="cb30-2"><a></a>    <span class="co">"""ZarrDataset multithread workers initialization function.</span></span>
<span id="cb30-3"><a></a><span class="co">    """</span></span>
<span id="cb30-4"><a></a>    worker_info <span class="op">=</span> torch.utils.data.get_worker_info()</span>
<span id="cb30-5"><a></a>    w_sel <span class="op">=</span> <span class="bu">slice</span>(worker_id, <span class="va">None</span>, worker_info.num_workers)</span>
<span id="cb30-6"><a></a></span>
<span id="cb30-7"><a></a>    dataset_obj <span class="op">=</span> worker_info.dataset</span>
<span id="cb30-8"><a></a></span>
<span id="cb30-9"><a></a>    <span class="co"># Reset the random number generators in each worker.</span></span>
<span id="cb30-10"><a></a>    torch_seed <span class="op">=</span> torch.initial_seed()</span>
<span id="cb30-11"><a></a></span>
<span id="cb30-12"><a></a>    dataset_obj._worker_sel <span class="op">=</span> w_sel</span>
<span id="cb30-13"><a></a>    dataset_obj._worker_id <span class="op">=</span> worker_id</span>
<span id="cb30-14"><a></a>    dataset_obj._num_workers <span class="op">=</span> worker_info.num_workers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-the-different-datasets-from-the-plates-lists" class="slide level2 scrollable">
<h2>Create the different datasets from the plates lists</h2>
<ul class="task-list">
<li><label><input type="checkbox">Instantiate a <code>TiffS3Dataset</code> from the plates assigned for training, validation, and testing</label></li>
</ul>
<div id="939785da" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a></a>training_ds <span class="op">=</span> TiffS3Dataset(pert_plate_maps, wells_metadata, trn_plates, <span class="dv">16</span>, <span class="dv">24</span>, <span class="dv">9</span>, <span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-2"><a></a>validation_ds <span class="op">=</span> TiffS3Dataset(pert_plate_maps, wells_metadata, val_plates, <span class="dv">16</span>, <span class="dv">24</span>, <span class="dv">9</span>, <span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-3"><a></a>testing_ds <span class="op">=</span> TiffS3Dataset(pert_plate_maps, wells_metadata, tst_plates, <span class="dv">16</span>, <span class="dv">24</span>, <span class="dv">9</span>, <span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="compute-field-level-morphological-profiles-from-perturbation-plates" class="title-slide slide level1 center">
<h1>Compute field-level morphological profiles from perturbation plates</h1>
<p>Weâ€™ll use a pre-trained deep learning model for image recognition to extract morphological features at field-level.</p>
<p>This process is usually applied at cell level; however, weâ€™ll analyze the data at field-level for simplicity.</p>
<p>These morphological profiles will be used subsequently to train a <em>perturbation classifier</em>.</p>
</section>
<section id="import-a-pre-trained-model-from-torchvision" class="slide level2">
<h2>Import a pre-trained model from <code>torchvision</code></h2>
<p>Weâ€™ll start with a pre-trained <em>MobileNet</em> model for feature extraction since it is lightweight and fast. This in terms of computation resources required to use this model.</p>
<p>In the literature, more complex models are used, such as Inception V3, DenseNet, or even Vision Transformers. However, these models require GPU acceleration to be efficiently applied.</p>
<ul class="task-list">
<li><label><input type="checkbox">Load a pre-trained <em>MobileNet</em> from the <code>torchvision</code> package</label></li>
</ul>
<div id="d8d00a5c" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a></a><span class="im">from</span> torchvision.models <span class="im">import</span> mobilenet_v3_small, MobileNet_V3_Small_Weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1f23d2e1" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a></a>weights <span class="op">=</span> MobileNet_V3_Small_Weights.DEFAULT</span>
<span id="cb33-2"><a></a>model <span class="op">=</span> mobilenet_v3_small(weights<span class="op">=</span>weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modify-the-models-architecture-to-convert-it-into-a-feature-extraction-function" class="slide level2 scrollable">
<h2>Modify the modelâ€™s architecture to convert it into a feature extraction <em>function</em></h2>
<ul class="task-list">
<li><label><input type="checkbox">Save the original aggregation layer (Average Pooling) and replace it with an <code>Identity</code> layer</label></li>
</ul>
<div id="9cc453f0" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a></a><span class="im">import</span> torch</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b10cd410" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a></a>org_avgpool <span class="op">=</span> model.avgpool</span>
<span id="cb35-2"><a></a>model.avgpool <span class="op">=</span> torch.nn.Identity()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Replace the original <code>classifier</code> layer with an <code>Identity</code> layer</label></li>
</ul>
<div id="b4b5436d" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a></a>model.classifier <span class="op">=</span> torch.nn.Identity()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modify-the-models-architecture-to-convert-it-into-a-feature-extraction-function-1" class="slide level2 scrollable">
<h2>Modify the modelâ€™s architecture to convert it into a feature extraction <em>function</em></h2>
<ul class="task-list">
<li><label><input type="checkbox">Set the model into <em>evaluation</em> mode. (Optional) Move the model to the GPU if available</label></li>
</ul>
<div id="477d97c2" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a></a><span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb37-2"><a></a>    model.cuda()</span>
<span id="cb37-3"><a></a></span>
<span id="cb37-4"><a></a>model.<span class="bu">eval</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>MobileNetV3(
  (features): Sequential(
    (0): Conv2dNormActivation(
      (0): Conv2d(3, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (1): BatchNorm2d(16, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
      (2): Hardswish()
    )
    (1): InvertedResidual(
      (block): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(16, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=16, bias=False)
          (1): BatchNorm2d(16, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): ReLU(inplace=True)
        )
        (1): SqueezeExcitation(
          (avgpool): AdaptiveAvgPool2d(output_size=1)
          (fc1): Conv2d(16, 8, kernel_size=(1, 1), stride=(1, 1))
          (fc2): Conv2d(8, 16, kernel_size=(1, 1), stride=(1, 1))
          (activation): ReLU()
          (scale_activation): Hardsigmoid()
        )
        (2): Conv2dNormActivation(
          (0): Conv2d(16, 16, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(16, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
    )
    (2): InvertedResidual(
      (block): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(16, 72, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(72, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): ReLU(inplace=True)
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(72, 72, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), groups=72, bias=False)
          (1): BatchNorm2d(72, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): ReLU(inplace=True)
        )
        (2): Conv2dNormActivation(
          (0): Conv2d(72, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(24, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
    )
    (3): InvertedResidual(
      (block): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(24, 88, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(88, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): ReLU(inplace=True)
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(88, 88, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=88, bias=False)
          (1): BatchNorm2d(88, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): ReLU(inplace=True)
        )
        (2): Conv2dNormActivation(
          (0): Conv2d(88, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(24, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
    )
    (4): InvertedResidual(
      (block): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(24, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(96, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(96, 96, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2), groups=96, bias=False)
          (1): BatchNorm2d(96, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (2): SqueezeExcitation(
          (avgpool): AdaptiveAvgPool2d(output_size=1)
          (fc1): Conv2d(96, 24, kernel_size=(1, 1), stride=(1, 1))
          (fc2): Conv2d(24, 96, kernel_size=(1, 1), stride=(1, 1))
          (activation): ReLU()
          (scale_activation): Hardsigmoid()
        )
        (3): Conv2dNormActivation(
          (0): Conv2d(96, 40, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(40, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
    )
    (5): InvertedResidual(
      (block): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(40, 240, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(240, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(240, 240, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=240, bias=False)
          (1): BatchNorm2d(240, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (2): SqueezeExcitation(
          (avgpool): AdaptiveAvgPool2d(output_size=1)
          (fc1): Conv2d(240, 64, kernel_size=(1, 1), stride=(1, 1))
          (fc2): Conv2d(64, 240, kernel_size=(1, 1), stride=(1, 1))
          (activation): ReLU()
          (scale_activation): Hardsigmoid()
        )
        (3): Conv2dNormActivation(
          (0): Conv2d(240, 40, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(40, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
    )
    (6): InvertedResidual(
      (block): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(40, 240, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(240, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(240, 240, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=240, bias=False)
          (1): BatchNorm2d(240, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (2): SqueezeExcitation(
          (avgpool): AdaptiveAvgPool2d(output_size=1)
          (fc1): Conv2d(240, 64, kernel_size=(1, 1), stride=(1, 1))
          (fc2): Conv2d(64, 240, kernel_size=(1, 1), stride=(1, 1))
          (activation): ReLU()
          (scale_activation): Hardsigmoid()
        )
        (3): Conv2dNormActivation(
          (0): Conv2d(240, 40, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(40, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
    )
    (7): InvertedResidual(
      (block): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(40, 120, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(120, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(120, 120, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=120, bias=False)
          (1): BatchNorm2d(120, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (2): SqueezeExcitation(
          (avgpool): AdaptiveAvgPool2d(output_size=1)
          (fc1): Conv2d(120, 32, kernel_size=(1, 1), stride=(1, 1))
          (fc2): Conv2d(32, 120, kernel_size=(1, 1), stride=(1, 1))
          (activation): ReLU()
          (scale_activation): Hardsigmoid()
        )
        (3): Conv2dNormActivation(
          (0): Conv2d(120, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(48, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
    )
    (8): InvertedResidual(
      (block): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(48, 144, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(144, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(144, 144, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=144, bias=False)
          (1): BatchNorm2d(144, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (2): SqueezeExcitation(
          (avgpool): AdaptiveAvgPool2d(output_size=1)
          (fc1): Conv2d(144, 40, kernel_size=(1, 1), stride=(1, 1))
          (fc2): Conv2d(40, 144, kernel_size=(1, 1), stride=(1, 1))
          (activation): ReLU()
          (scale_activation): Hardsigmoid()
        )
        (3): Conv2dNormActivation(
          (0): Conv2d(144, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(48, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
    )
    (9): InvertedResidual(
      (block): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(48, 288, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(288, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(288, 288, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2), groups=288, bias=False)
          (1): BatchNorm2d(288, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (2): SqueezeExcitation(
          (avgpool): AdaptiveAvgPool2d(output_size=1)
          (fc1): Conv2d(288, 72, kernel_size=(1, 1), stride=(1, 1))
          (fc2): Conv2d(72, 288, kernel_size=(1, 1), stride=(1, 1))
          (activation): ReLU()
          (scale_activation): Hardsigmoid()
        )
        (3): Conv2dNormActivation(
          (0): Conv2d(288, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(96, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
    )
    (10): InvertedResidual(
      (block): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(96, 576, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(576, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(576, 576, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=576, bias=False)
          (1): BatchNorm2d(576, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (2): SqueezeExcitation(
          (avgpool): AdaptiveAvgPool2d(output_size=1)
          (fc1): Conv2d(576, 144, kernel_size=(1, 1), stride=(1, 1))
          (fc2): Conv2d(144, 576, kernel_size=(1, 1), stride=(1, 1))
          (activation): ReLU()
          (scale_activation): Hardsigmoid()
        )
        (3): Conv2dNormActivation(
          (0): Conv2d(576, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(96, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
    )
    (11): InvertedResidual(
      (block): Sequential(
        (0): Conv2dNormActivation(
          (0): Conv2d(96, 576, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(576, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (1): Conv2dNormActivation(
          (0): Conv2d(576, 576, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), groups=576, bias=False)
          (1): BatchNorm2d(576, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): Hardswish()
        )
        (2): SqueezeExcitation(
          (avgpool): AdaptiveAvgPool2d(output_size=1)
          (fc1): Conv2d(576, 144, kernel_size=(1, 1), stride=(1, 1))
          (fc2): Conv2d(144, 576, kernel_size=(1, 1), stride=(1, 1))
          (activation): ReLU()
          (scale_activation): Hardsigmoid()
        )
        (3): Conv2dNormActivation(
          (0): Conv2d(576, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(96, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
    )
    (12): Conv2dNormActivation(
      (0): Conv2d(96, 576, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (1): BatchNorm2d(576, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
      (2): Hardswish()
    )
  )
  (avgpool): Identity()
  (classifier): Identity()
)</code></pre>
</div>
</div>
</section>
<section id="load-the-pre-processing-transforms-form-the-original-model" class="slide level2 scrollable">
<h2>Load the pre-processing transforms form the original model</h2>
<p>We need to apply the same transforms to the images that we <em>feed</em> to the model to have the expected behavior.</p>
<ul class="task-list">
<li><label><input type="checkbox">Get the original transforms pipeline used when the model was originally trained</label></li>
</ul>
<div id="df18c6f8" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a></a>model_transforms <span class="op">=</span> weights.transforms()</span>
<span id="cb39-2"><a></a>model_transforms</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>ImageClassification(
    crop_size=[224]
    resize_size=[256]
    mean=[0.485, 0.456, 0.406]
    std=[0.229, 0.224, 0.225]
    interpolation=InterpolationMode.BILINEAR
)</code></pre>
</div>
</div>
</section>
<section id="create-a-pytorch-dataloader" class="slide level2">
<h2>Create a PyTorch <code>DataLoader</code></h2>
<p>A <code>DataLoader</code> takes a <code>Dataset</code> (or <code>IterableDataset</code>) and serves <em>mini-batches</em> of samples that can be used for model training or evaluation. It manages the <em>mini-batch</em> collation, and if enabled, the <em>multi-thread</em> loading of data.</p>
<div id="9125cbdc" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a></a><span class="im">from</span> torch.utils.data.dataloader <span class="im">import</span> DataLoader</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="07380306" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a></a>batch_size <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb42-2"><a></a></span>
<span id="cb42-3"><a></a>training_dl <span class="op">=</span> DataLoader(training_ds, batch_size<span class="op">=</span>batch_size, num_workers<span class="op">=</span><span class="dv">2</span>, worker_init_fn<span class="op">=</span>dataset_worker_init_fn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="execute-the-feature-extraction-with-the-deep-learning-model" class="slide level2 scrollable">
<h2>Execute the feature extraction with the deep learning model</h2>
<ul class="task-list">
<li><label><input type="checkbox">Use the <em>frozen</em> deep learning model to extract morphological features from the field-level images and create a features database</label></li>
</ul>
<div id="431e3bd7" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a></a><span class="im">from</span> tqdm.auto <span class="im">import</span> tqdm</span>
<span id="cb43-2"><a></a></span>
<span id="cb43-3"><a></a>features <span class="op">=</span> []</span>
<span id="cb43-4"><a></a>targets <span class="op">=</span> []</span>
<span id="cb43-5"><a></a></span>
<span id="cb43-6"><a></a><span class="cf">for</span> i, (x, y, _) <span class="kw">in</span> tqdm(<span class="bu">enumerate</span>(training_dl)):</span>
<span id="cb43-7"><a></a>    b, c, h, w <span class="op">=</span> x.shape</span>
<span id="cb43-8"><a></a>    x_t <span class="op">=</span> model_transforms(torch.tile(x.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, h, w), (<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>)))</span>
<span id="cb43-9"><a></a></span>
<span id="cb43-10"><a></a>    <span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb43-11"><a></a>        x_t <span class="op">=</span> x_t.cuda()</span>
<span id="cb43-12"><a></a>    </span>
<span id="cb43-13"><a></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb43-14"><a></a>        x_out <span class="op">=</span> model(x_t)</span>
<span id="cb43-15"><a></a>        x_out <span class="op">=</span> x_out.detach().cpu().reshape(<span class="op">-</span><span class="dv">1</span>, c, <span class="dv">576</span>, <span class="dv">7</span>, <span class="dv">7</span>).<span class="bu">sum</span>(dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb43-16"><a></a>        x_out <span class="op">=</span> org_avgpool(x_out).detach().reshape(b, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb43-17"><a></a></span>
<span id="cb43-18"><a></a>    features.append(x_out)</span>
<span id="cb43-19"><a></a>    targets.append(y)</span>
<span id="cb43-20"><a></a></span>
<span id="cb43-21"><a></a>    <span class="co"># This is for illustration purposes.</span></span>
<span id="cb43-22"><a></a>    <span class="co"># We'll load the pre-extracted features from Cloud Storage, so no need to generate it here.</span></span>
<span id="cb43-23"><a></a>    <span class="cf">break</span></span>
<span id="cb43-24"><a></a></span>
<span id="cb43-25"><a></a>features <span class="op">=</span> torch.cat(features, dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb43-26"><a></a>targets <span class="op">=</span> torch.cat(targets, dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb43-27"><a></a></span>
<span id="cb43-28"><a></a>features.shape, targets.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"484a4637bc704df6847d71f4776810f8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>(torch.Size([10, 576]), torch.Size([10]))</code></pre>
</div>
</div>
</section>
<section id="execute-the-feature-extraction-with-the-deep-learning-model-1" class="slide level2 scrollable">
<h2>Execute the feature extraction with the deep learning model</h2>
<ul class="task-list">
<li><label><input type="checkbox">Perform the same operation for the <strong>validation</strong> set</label></li>
</ul>
<div id="abb23b0e" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a></a>val_features <span class="op">=</span> []</span>
<span id="cb45-2"><a></a>val_targets <span class="op">=</span> []</span>
<span id="cb45-3"><a></a></span>
<span id="cb45-4"><a></a>validation_dl <span class="op">=</span> DataLoader(validation_ds, batch_size<span class="op">=</span>batch_size, num_workers<span class="op">=</span><span class="dv">2</span>, worker_init_fn<span class="op">=</span>dataset_worker_init_fn)</span>
<span id="cb45-5"><a></a></span>
<span id="cb45-6"><a></a><span class="cf">for</span> i, (x, y, _) <span class="kw">in</span> tqdm(<span class="bu">enumerate</span>(validation_dl)):</span>
<span id="cb45-7"><a></a>    b, c, h, w <span class="op">=</span> x.shape</span>
<span id="cb45-8"><a></a>    x_t <span class="op">=</span> model_transforms(torch.tile(x.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, h, w), (<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>)))</span>
<span id="cb45-9"><a></a></span>
<span id="cb45-10"><a></a>    <span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb45-11"><a></a>        x_t <span class="op">=</span> x_t.cuda()</span>
<span id="cb45-12"><a></a>    </span>
<span id="cb45-13"><a></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb45-14"><a></a>        x_out <span class="op">=</span> model(x_t)</span>
<span id="cb45-15"><a></a>        x_out <span class="op">=</span> x_out.detach().reshape(<span class="op">-</span><span class="dv">1</span>, c, <span class="dv">576</span>, <span class="dv">7</span>, <span class="dv">7</span>).<span class="bu">sum</span>(dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb45-16"><a></a>        x_out <span class="op">=</span> org_avgpool(x_out).detach().reshape(b, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb45-17"><a></a></span>
<span id="cb45-18"><a></a>    val_features.append(x_out)</span>
<span id="cb45-19"><a></a>    val_targets.append(y)</span>
<span id="cb45-20"><a></a></span>
<span id="cb45-21"><a></a>    <span class="cf">break</span></span>
<span id="cb45-22"><a></a></span>
<span id="cb45-23"><a></a>val_features <span class="op">=</span> torch.cat(val_features, dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb45-24"><a></a>val_targets <span class="op">=</span> torch.cat(val_targets, dim<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ec950503d0494a66b435854bdceb9056","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
</section>
<section id="execute-the-feature-extraction-with-the-deep-learning-model-2" class="slide level2 scrollable">
<h2>Execute the feature extraction with the deep learning model</h2>
<ul class="task-list">
<li><label><input type="checkbox">And again for the testing set</label></li>
</ul>
<div id="cf683275" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a></a>tst_features <span class="op">=</span> []</span>
<span id="cb46-2"><a></a>tst_targets <span class="op">=</span> []</span>
<span id="cb46-3"><a></a></span>
<span id="cb46-4"><a></a>testing_dl <span class="op">=</span> DataLoader(testing_ds, batch_size<span class="op">=</span>batch_size, num_workers<span class="op">=</span><span class="dv">2</span>, worker_init_fn<span class="op">=</span>dataset_worker_init_fn)</span>
<span id="cb46-5"><a></a></span>
<span id="cb46-6"><a></a><span class="cf">for</span> i, (x, y, _) <span class="kw">in</span> tqdm(<span class="bu">enumerate</span>(testing_dl)):</span>
<span id="cb46-7"><a></a>    b, c, h, w <span class="op">=</span> x.shape</span>
<span id="cb46-8"><a></a>    x_t <span class="op">=</span> model_transforms(torch.tile(x.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, h, w), (<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>)))</span>
<span id="cb46-9"><a></a></span>
<span id="cb46-10"><a></a>    <span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb46-11"><a></a>        x_t <span class="op">=</span> x_t.cuda()</span>
<span id="cb46-12"><a></a>    </span>
<span id="cb46-13"><a></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb46-14"><a></a>        x_out <span class="op">=</span> model(x_t)</span>
<span id="cb46-15"><a></a>        x_out <span class="op">=</span> x_out.detach().reshape(<span class="op">-</span><span class="dv">1</span>, c, <span class="dv">576</span>, <span class="dv">7</span>, <span class="dv">7</span>).<span class="bu">sum</span>(dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb46-16"><a></a>        x_out <span class="op">=</span> org_avgpool(x_out).detach().reshape(b, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb46-17"><a></a></span>
<span id="cb46-18"><a></a>    tst_features.append(x_out)</span>
<span id="cb46-19"><a></a>    tst_targets.append(y)</span>
<span id="cb46-20"><a></a></span>
<span id="cb46-21"><a></a>    <span class="cf">break</span></span>
<span id="cb46-22"><a></a></span>
<span id="cb46-23"><a></a>tst_features <span class="op">=</span> torch.cat(tst_features, dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb46-24"><a></a>tst_targets <span class="op">=</span> torch.cat(tst_targets, dim<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a548203dfb2d495680fbdef26b0debf7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Failed retrieving: s3://cellpainting-gallery/cpg0016-jump/source_10/images/2021_06_28_U2OS_48_hr_run9/images/Dest210628-162003/Dest210628-162003_C17_T0001F008L01A01Z01C01.tif
Failed retrieving: s3://cellpainting-gallery/cpg0016-jump/source_10/images/2021_06_28_U2OS_48_hr_run9/images/Dest210628-162003/Dest210628-162003_M16_T0001F007L01A01Z01C01.tif</code></pre>
</div>
</div>
</section></section>
<section>
<section id="train-a-perturbation-classifier-model" class="title-slide slide level1 center">
<h1>Train a perturbation classifier model</h1>
<p>Weâ€™ll take the pre-extracted features and train a perturbation classifier.</p>
<p>This approach will use a Multilayer Perceptron (<strong>MLP</strong>) model to classify the field-level profiles into three categories: <em>NONE/DMSO</em> = 0, <em>CRISPR</em> = 1, and <em>ORF</em> = 2.</p>
<p>The model will be fitted using <em>Adam</em> optimizer, which objective is to reduce the <em>Cross Entropy</em> loss between the predicted and the ground-truth category of each field.</p>
</section>
<section id="load-the-pre-extracted-features-to-train-the-classifier" class="slide level2 scrollable">
<h2>Load the pre-extracted features to train the classifier</h2>
<ul class="task-list">
<li><label><input type="checkbox">Define an <code>IterableDataset</code> to load the features from the <code>trn_feature_XXX.pt</code> files</label></li>
</ul>
<div id="e21cab06" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a></a><span class="kw">class</span> GCPStorageDataset(IterableDataset):</span>
<span id="cb48-2"><a></a>    <span class="co">"""This dataset loads the features from Cloud Storage</span></span>
<span id="cb48-3"><a></a><span class="co">    """</span></span>
<span id="cb48-4"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, features_url, reducer<span class="op">=</span><span class="va">None</span>, shuffle<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb48-5"><a></a>        <span class="bu">super</span>(GCPStorageDataset).<span class="fu">__init__</span>()</span>
<span id="cb48-6"><a></a></span>
<span id="cb48-7"><a></a>        <span class="va">self</span>._features_url <span class="op">=</span> features_url</span>
<span id="cb48-8"><a></a>        <span class="va">self</span>._features_dict <span class="op">=</span> <span class="va">None</span></span>
<span id="cb48-9"><a></a>        <span class="va">self</span>._reducer <span class="op">=</span> reducer</span>
<span id="cb48-10"><a></a></span>
<span id="cb48-11"><a></a>        <span class="va">self</span>._shuffle <span class="op">=</span> shuffle</span>
<span id="cb48-12"><a></a></span>
<span id="cb48-13"><a></a>        <span class="va">self</span>._worker_sel <span class="op">=</span> <span class="bu">slice</span>(<span class="dv">0</span>, <span class="bu">len</span>(<span class="va">self</span>._features_url))</span>
<span id="cb48-14"><a></a>        <span class="va">self</span>._worker_id <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb48-15"><a></a>        <span class="va">self</span>._num_workers <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb48-16"><a></a></span>
<span id="cb48-17"><a></a>    <span class="kw">def</span> <span class="fu">__iter__</span>(<span class="va">self</span>):</span>
<span id="cb48-18"><a></a>        <span class="co"># Select the barcodes that correspond to this worker</span></span>
<span id="cb48-19"><a></a>        <span class="va">self</span>._features_url <span class="op">=</span> <span class="va">self</span>._features_url[<span class="va">self</span>._worker_sel]</span>
<span id="cb48-20"><a></a></span>
<span id="cb48-21"><a></a>        <span class="cf">if</span> <span class="va">self</span>._shuffle:</span>
<span id="cb48-22"><a></a>            random.shuffle(<span class="va">self</span>._features_url)</span>
<span id="cb48-23"><a></a></span>
<span id="cb48-24"><a></a>        <span class="cf">for</span> url <span class="kw">in</span> <span class="va">self</span>._features_url:</span>
<span id="cb48-25"><a></a>            features_dict <span class="op">=</span> torch.load(url)</span>
<span id="cb48-26"><a></a>            </span>
<span id="cb48-27"><a></a>            <span class="cf">if</span> <span class="va">self</span>._reducer <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb48-28"><a></a>                embeddings <span class="op">=</span> reducer.transform(features_dict[<span class="st">"features"</span>])</span>
<span id="cb48-29"><a></a></span>
<span id="cb48-30"><a></a>            curr_n_samples <span class="op">=</span> <span class="bu">len</span>(features_dict[<span class="st">"features"</span>])</span>
<span id="cb48-31"><a></a></span>
<span id="cb48-32"><a></a>            <span class="cf">for</span> index <span class="kw">in</span> <span class="bu">range</span>(curr_n_samples):</span>
<span id="cb48-33"><a></a>                <span class="cf">if</span> <span class="va">self</span>._shuffle:</span>
<span id="cb48-34"><a></a>                    index <span class="op">=</span> random.randrange(curr_n_samples)</span>
<span id="cb48-35"><a></a></span>
<span id="cb48-36"><a></a>                feats <span class="op">=</span> features_dict[<span class="st">"features"</span>][index]</span>
<span id="cb48-37"><a></a>                target <span class="op">=</span> features_dict[<span class="st">"targets"</span>][index]</span>
<span id="cb48-38"><a></a></span>
<span id="cb48-39"><a></a>                <span class="cf">if</span> <span class="va">self</span>._reducer <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb48-40"><a></a>                    reduced_feats <span class="op">=</span> embeddings[index]</span>
<span id="cb48-41"><a></a>                <span class="cf">else</span>:</span>
<span id="cb48-42"><a></a>                    reduced_feats <span class="op">=</span> <span class="va">None</span></span>
<span id="cb48-43"><a></a></span>
<span id="cb48-44"><a></a>                <span class="cf">yield</span> feats, target, reduced_feats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inspect-the-distribution-of-the-feature-space" class="slide level2">
<h2>Inspect the distribution of the feature space</h2>
<ul class="task-list">
<li><label><input type="checkbox">Fit a UMap to the training set of features to reduce the <span class="math inline">\(576\)</span> features into only <span class="math inline">\(2\)</span> dimensions for visualization</label></li>
</ul>
<div id="399e35f6" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a></a><span class="im">import</span> umap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="414867b4" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a></a>reducer <span class="op">=</span> umap.UMAP()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inspect-the-distribution-of-the-feature-space-1" class="slide level2">
<h2>Inspect the distribution of the feature space</h2>
<ul class="task-list">
<li><label><input type="checkbox">Load the training features and fit the UMap reducer</label></li>
</ul>
<div id="efefa862" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a></a>trn_features_ds <span class="op">=</span> GCPStorageDataset([<span class="st">"trn_features_002.pt"</span>], shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb51-2"><a></a></span>
<span id="cb51-3"><a></a>trn_features, trn_targets, _ <span class="op">=</span> <span class="bu">list</span>(<span class="bu">zip</span>(<span class="op">*</span>trn_features_ds))</span>
<span id="cb51-4"><a></a></span>
<span id="cb51-5"><a></a>trn_targets <span class="op">=</span> torch.tensor(trn_targets)</span>
<span id="cb51-6"><a></a></span>
<span id="cb51-7"><a></a>reducer.fit(trn_features)</span>
<span id="cb51-8"><a></a></span>
<span id="cb51-9"><a></a>trn_embeddings <span class="op">=</span> reducer.transform(trn_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inspect-the-distribution-of-the-feature-space-2" class="slide level2 scrollable">
<h2>Inspect the distribution of the feature space</h2>
<ul class="task-list">
<li><label><input type="checkbox">Visualize the reduced feature space in two dimensions</label></li>
</ul>
<div id="b6e7107e" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb52-2"><a></a></span>
<span id="cb52-3"><a></a>class_names <span class="op">=</span> [<span class="st">"NONE/DMSO"</span>, <span class="st">"CRISPR"</span>, <span class="st">"ORF"</span>, <span class="st">"COMPOUND"</span>]</span>
<span id="cb52-4"><a></a>class_markers <span class="op">=</span> [<span class="st">"*"</span>, <span class="st">"s"</span>, <span class="st">"o"</span>, <span class="st">"^"</span>]</span>
<span id="cb52-5"><a></a>class_colors <span class="op">=</span> [<span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>]</span>
<span id="cb52-6"><a></a>class_facecolors <span class="op">=</span> [<span class="st">"black"</span>, <span class="st">"none"</span>, <span class="st">"none"</span>, <span class="st">"none"</span>]</span>
<span id="cb52-7"><a></a></span>
<span id="cb52-8"><a></a><span class="cf">for</span> class_idx, class_name <span class="kw">in</span> <span class="bu">enumerate</span>(class_names):</span>
<span id="cb52-9"><a></a>    plt.scatter(trn_embeddings[trn_targets <span class="op">==</span> class_idx, <span class="dv">0</span>][::<span class="dv">10</span>], trn_embeddings[trn_targets <span class="op">==</span> class_idx, <span class="dv">1</span>][::<span class="dv">10</span>], label<span class="op">=</span>class_names[class_idx], marker<span class="op">=</span>class_markers[class_idx], facecolors<span class="op">=</span>class_facecolors[class_idx], edgecolors<span class="op">=</span>class_colors[class_idx])</span>
<span id="cb52-10"><a></a></span>
<span id="cb52-11"><a></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="DL_image_analysis_2_files/figure-revealjs/cell-44-output-1.png" width="789" height="411"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="inspect-the-distribution-of-the-feature-space-3" class="slide level2 scrollable">
<h2>Inspect the distribution of the feature space</h2>
<ul class="task-list">
<li><label><input type="checkbox">Confirm that the validation set is mapped to a similar space as the training set</label></li>
</ul>
<div id="3a8d04e7" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a></a>val_features_ds <span class="op">=</span> GCPStorageDataset([<span class="st">"val_features.pt"</span>], shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb53-2"><a></a></span>
<span id="cb53-3"><a></a>val_features, val_targets, _ <span class="op">=</span> <span class="bu">list</span>(<span class="bu">zip</span>(<span class="op">*</span>val_features_ds))</span>
<span id="cb53-4"><a></a></span>
<span id="cb53-5"><a></a>val_targets <span class="op">=</span> torch.tensor(val_targets)</span>
<span id="cb53-6"><a></a></span>
<span id="cb53-7"><a></a>val_embedding <span class="op">=</span> reducer.transform(val_features)</span>
<span id="cb53-8"><a></a></span>
<span id="cb53-9"><a></a>val_embedding.shape</span>
<span id="cb53-10"><a></a></span>
<span id="cb53-11"><a></a><span class="cf">for</span> class_idx, class_name <span class="kw">in</span> <span class="bu">enumerate</span>(class_names):</span>
<span id="cb53-12"><a></a>    plt.scatter(val_embedding[val_targets <span class="op">==</span> class_idx, <span class="dv">0</span>][::<span class="dv">10</span>], val_embedding[val_targets <span class="op">==</span> class_idx, <span class="dv">1</span>][::<span class="dv">10</span>], label<span class="op">=</span>class_names[class_idx], marker<span class="op">=</span>class_markers[class_idx], facecolors<span class="op">=</span>class_facecolors[class_idx], edgecolors<span class="op">=</span>class_colors[class_idx])</span>
<span id="cb53-13"><a></a></span>
<span id="cb53-14"><a></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="DL_image_analysis_2_files/figure-revealjs/cell-45-output-1.png" width="789" height="411"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="create-a-classifier-with-a-multilayer-perceptron-mlp-architecture" class="slide level2 scrollable">
<h2>Create a classifier with a Multilayer Perceptron (<strong>MLP</strong>) architecture</h2>
<p>The <em>MobileNet</em> model extracts <span class="math inline">\(576\)</span> features per image, these will be the input features for the <em>MLP</em> classifer.</p>
<ul class="task-list">
<li><label><input type="checkbox">Define a Multilayer Perceptron <em>MLP</em> classifier that takes the pre-extracted features and predicts the perturbation applied to that sample</label></li>
</ul>
<div id="ddc6791c" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a></a><span class="kw">class</span> PerturbationClassifier(torch.nn.Module):</span>
<span id="cb54-2"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, num_features, num_classes):</span>
<span id="cb54-3"><a></a>        <span class="bu">super</span>(PerturbationClassifier, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb54-4"><a></a></span>
<span id="cb54-5"><a></a>        <span class="va">self</span>._reducer <span class="op">=</span> torch.nn.Sequential(</span>
<span id="cb54-6"><a></a>            torch.nn.BatchNorm1d(num_features<span class="op">=</span>num_features),</span>
<span id="cb54-7"><a></a>            torch.nn.Linear(in_features<span class="op">=</span>num_features, out_features<span class="op">=</span><span class="dv">2</span>, bias<span class="op">=</span><span class="va">False</span>),</span>
<span id="cb54-8"><a></a>        )</span>
<span id="cb54-9"><a></a></span>
<span id="cb54-10"><a></a>        <span class="va">self</span>._classifier <span class="op">=</span> torch.nn.Sequential(</span>
<span id="cb54-11"><a></a>            torch.nn.Dropout(<span class="fl">0.1</span>),</span>
<span id="cb54-12"><a></a>            torch.nn.ReLU(),</span>
<span id="cb54-13"><a></a>            torch.nn.Linear(in_features<span class="op">=</span><span class="dv">2</span>, out_features<span class="op">=</span>num_classes, bias<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb54-14"><a></a>        )</span>
<span id="cb54-15"><a></a></span>
<span id="cb54-16"><a></a>    <span class="kw">def</span> forward(<span class="va">self</span>, <span class="bu">input</span>):</span>
<span id="cb54-17"><a></a>        fx <span class="op">=</span> <span class="va">self</span>._reducer(<span class="bu">input</span>)</span>
<span id="cb54-18"><a></a>        </span>
<span id="cb54-19"><a></a>        y_pred <span class="op">=</span> <span class="va">self</span>._classifier(fx)</span>
<span id="cb54-20"><a></a></span>
<span id="cb54-21"><a></a>        <span class="cf">return</span> y_pred, fx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-a-classifier-with-a-multilayer-perceptron-mlp-architecture-1" class="slide level2 scrollable">
<h2>Create a classifier with a Multilayer Perceptron (<strong>MLP</strong>) architecture</h2>
<ul class="task-list">
<li><label><input type="checkbox">Instantiate the classifier for the set of <span class="math inline">\(576\)</span> features and <span class="math inline">\(3\)</span> classes</label></li>
</ul>
<div id="95d84c24" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a></a>classifier <span class="op">=</span> PerturbationClassifier(<span class="dv">576</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">(Optional) If a GPU is available, move the classifier model to it</label></li>
</ul>
<div id="b0198d22" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a></a><span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb56-2"><a></a>    classifier.cuda()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-a-classifier-with-a-multilayer-perceptron-mlp-architecture-2" class="slide level2 scrollable">
<h2>Create a classifier with a Multilayer Perceptron (<strong>MLP</strong>) architecture</h2>
<ul class="task-list">
<li><label><input type="checkbox">Define the optimizer algorithm</label></li>
</ul>
<div id="3e8b431d" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a></a>optimizer <span class="op">=</span> torch.optim.Adam([</span>
<span id="cb57-2"><a></a>    {<span class="st">'params'</span>: classifier._reducer.parameters(), <span class="st">'lr'</span>: <span class="fl">1e-5</span>, <span class="st">'weight_decay'</span>: <span class="fl">0.001</span>},</span>
<span id="cb57-3"><a></a>    {<span class="st">'params'</span>: classifier._classifier.parameters(), <span class="st">'lr'</span>: <span class="fl">1e-4</span>}</span>
<span id="cb57-4"><a></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Define the loss function used to assess the classification performance of the model</label></li>
</ul>
<div id="a3dab80d" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a></a>classifier_loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb58-2"><a></a>reducer_loss_fn <span class="op">=</span> torch.nn.MSELoss()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="train-the-mlp-model" class="slide level2 scrollable">
<h2>Train the <em>MLP</em> model</h2>
<ul class="task-list">
<li><label><input type="checkbox">Instantiate the datasets that will load the features from Cloud Storage</label></li>
</ul>
<div id="109af252" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a></a>trn_feat_ds <span class="op">=</span> GCPStorageDataset([<span class="ss">f"trn_features_</span><span class="sc">{</span>i<span class="sc">:03d}</span><span class="ss">.pt"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)], reducer<span class="op">=</span>reducer, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb59-2"><a></a>val_feat_ds <span class="op">=</span> GCPStorageDataset([<span class="st">"val_features.pt"</span>], reducer<span class="op">=</span>reducer, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb59-3"><a></a>tst_feat_ds <span class="op">=</span> GCPStorageDataset([<span class="st">"tst_features.pt"</span>], reducer<span class="op">=</span>reducer, shuffle<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Create one <code>DataLoader</code> for the training set and one for the validation set of pre-extracted features</label></li>
</ul>
<div id="c6ee56e2" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a></a>trn_feat_dl <span class="op">=</span> DataLoader(trn_feat_ds, batch_size<span class="op">=</span><span class="dv">100</span>, num_workers<span class="op">=</span><span class="dv">2</span>, worker_init_fn<span class="op">=</span>dataset_worker_init_fn)</span>
<span id="cb60-2"><a></a>val_feat_dl <span class="op">=</span> DataLoader(val_feat_ds, batch_size<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb60-3"><a></a>tst_feat_dl <span class="op">=</span> DataLoader(tst_feat_ds, batch_size<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="train-the-mlp-model-1" class="slide level2 scrollable">
<h2>Train the <em>MLP</em> model</h2>
<ul class="task-list">
<li><label><input type="checkbox">Implement the training loop</label></li>
</ul>
<div id="053df4c6" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a></a><span class="im">from</span> torchmetrics.classification <span class="im">import</span> Accuracy</span>
<span id="cb61-2"><a></a></span>
<span id="cb61-3"><a></a>n_dmso <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb61-4"><a></a>n_crispr <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb61-5"><a></a>n_orf <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb61-6"><a></a></span>
<span id="cb61-7"><a></a><span class="co"># Training loop</span></span>
<span id="cb61-8"><a></a>classifier.train()</span>
<span id="cb61-9"><a></a></span>
<span id="cb61-10"><a></a>cls_loss_epoch <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb61-11"><a></a>red_loss_epoch <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb61-12"><a></a></span>
<span id="cb61-13"><a></a>trn_acc_metric <span class="op">=</span> Accuracy(task<span class="op">=</span><span class="st">"multiclass"</span>, num_classes<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb61-14"><a></a></span>
<span id="cb61-15"><a></a><span class="cf">for</span> x, y, fx <span class="kw">in</span> tqdm(trn_feat_dl, total<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb61-16"><a></a>    optimizer.zero_grad()</span>
<span id="cb61-17"><a></a></span>
<span id="cb61-18"><a></a>    <span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb61-19"><a></a>        x <span class="op">=</span> x.cuda()</span>
<span id="cb61-20"><a></a></span>
<span id="cb61-21"><a></a>    y_pred, fx_pred <span class="op">=</span> classifier(x)</span>
<span id="cb61-22"><a></a></span>
<span id="cb61-23"><a></a>    cls_loss <span class="op">=</span> classifier_loss_fn(y_pred.cpu(), y)</span>
<span id="cb61-24"><a></a>    red_loss <span class="op">=</span> reducer_loss_fn(fx_pred.cpu(), fx)</span>
<span id="cb61-25"><a></a></span>
<span id="cb61-26"><a></a>    cls_loss.backward(retain_graph<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb61-27"><a></a>    red_loss.backward()</span>
<span id="cb61-28"><a></a></span>
<span id="cb61-29"><a></a>    optimizer.step()</span>
<span id="cb61-30"><a></a></span>
<span id="cb61-31"><a></a>    cls_loss_epoch <span class="op">+=</span> cls_loss.item()</span>
<span id="cb61-32"><a></a>    red_loss_epoch <span class="op">+=</span> red_loss.item()</span>
<span id="cb61-33"><a></a></span>
<span id="cb61-34"><a></a>    trn_acc_metric(y_pred.cpu().softmax(dim<span class="op">=</span><span class="dv">1</span>), y)</span>
<span id="cb61-35"><a></a></span>
<span id="cb61-36"><a></a>    n_dmso <span class="op">+=</span> <span class="bu">sum</span>(y <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb61-37"><a></a>    n_crispr <span class="op">+=</span> <span class="bu">sum</span>(y <span class="op">==</span> <span class="dv">1</span>)</span>
<span id="cb61-38"><a></a>    n_orf <span class="op">+=</span> <span class="bu">sum</span>(y <span class="op">==</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ced82da163cc451a86315db121d9d9bd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
</section>
<section id="train-the-mlp-model-2" class="slide level2 scrollable">
<h2>Train the <em>MLP</em> model</h2>
<ul class="task-list">
<li><label><input type="checkbox">Compute the proportion of samples per category in the training set</label></li>
</ul>
<div id="8048d05f" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a></a>n_total <span class="op">=</span> n_dmso <span class="op">+</span> n_crispr <span class="op">+</span> n_orf</span>
<span id="cb62-2"><a></a>n_dmso <span class="op">/</span> n_total, n_crispr <span class="op">/</span> n_total, n_orf <span class="op">/</span> n_total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>(tensor(0.0107), tensor(0.3617), tensor(0.6276))</code></pre>
</div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Check the average loss metric of the model on the training set</label></li>
</ul>
<div id="00fdd4f8" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a></a>cls_loss_epoch <span class="op">/</span> n_total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>tensor(0.0090)</code></pre>
</div>
</div>
<div id="357d1191" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a></a>red_loss_epoch <span class="op">/</span> n_total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>tensor(0.8626)</code></pre>
</div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Compute the average accuracy of the model on the training set</label></li>
</ul>
<div id="f9c3ed22" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a></a>trn_acc_metric.compute()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>tensor(0.5685)</code></pre>
</div>
</div>
</section>
<section id="train-the-mlp-model-3" class="slide level2 scrollable">
<h2>Train the <em>MLP</em> model</h2>
<ul class="task-list">
<li><label><input type="checkbox">Implement the validation loop</label></li>
</ul>
<div id="96ccac58" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a></a>n_dmso <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb70-2"><a></a>n_crispr <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb70-3"><a></a>n_orf <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb70-4"><a></a></span>
<span id="cb70-5"><a></a>cls_loss_epoch <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb70-6"><a></a>red_loss_epoch <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb70-7"><a></a></span>
<span id="cb70-8"><a></a>val_acc_metric <span class="op">=</span> Accuracy(task<span class="op">=</span><span class="st">"multiclass"</span>, num_classes<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb70-9"><a></a></span>
<span id="cb70-10"><a></a><span class="cf">for</span> x_val, y_val, fx_val <span class="kw">in</span> tqdm(val_feat_dl):</span>
<span id="cb70-11"><a></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb70-12"><a></a>        <span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb70-13"><a></a>            x_val <span class="op">=</span> x_val.cuda()</span>
<span id="cb70-14"><a></a></span>
<span id="cb70-15"><a></a>        y_val_pred, fx_val_pred <span class="op">=</span> classifier(x_val)</span>
<span id="cb70-16"><a></a></span>
<span id="cb70-17"><a></a>        cls_loss <span class="op">=</span> classifier_loss_fn(y_val_pred.cpu(), y_val)</span>
<span id="cb70-18"><a></a>        red_loss <span class="op">=</span> reducer_loss_fn(fx_val_pred.cpu(), fx_val)</span>
<span id="cb70-19"><a></a></span>
<span id="cb70-20"><a></a>    cls_loss_epoch <span class="op">+=</span> cls_loss.item()</span>
<span id="cb70-21"><a></a>    red_loss_epoch <span class="op">+=</span> red_loss.item()</span>
<span id="cb70-22"><a></a>    </span>
<span id="cb70-23"><a></a>    val_acc_metric(y_val_pred.cpu().softmax(dim<span class="op">=</span><span class="dv">1</span>), y_val)</span>
<span id="cb70-24"><a></a></span>
<span id="cb70-25"><a></a>    n_dmso <span class="op">+=</span> <span class="bu">sum</span>(y_val <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb70-26"><a></a>    n_crispr <span class="op">+=</span> <span class="bu">sum</span>(y_val <span class="op">==</span> <span class="dv">1</span>)</span>
<span id="cb70-27"><a></a>    n_orf <span class="op">+=</span> <span class="bu">sum</span>(y_val <span class="op">==</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8baf3a17f70d46088a9852c32d20b86f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
</section>
<section id="train-the-mlp-model-4" class="slide level2 scrollable">
<h2>Train the <em>MLP</em> model</h2>
<ul class="task-list">
<li><label><input type="checkbox">Compute the proportion of samples per category in the validation set</label></li>
</ul>
<div id="5469e7e4" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a></a>n_total <span class="op">=</span> n_dmso <span class="op">+</span> n_crispr <span class="op">+</span> n_orf</span>
<span id="cb71-2"><a></a>n_dmso <span class="op">/</span> n_total, n_crispr <span class="op">/</span> n_total, n_orf <span class="op">/</span> n_total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>(tensor(0.0182), tensor(0.3486), tensor(0.6332))</code></pre>
</div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Check the average loss metric of the model on the validation set</label></li>
</ul>
<div id="a777ec5c" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a></a>cls_loss_epoch <span class="op">/</span> n_total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>tensor(0.0074)</code></pre>
</div>
</div>
<div id="beb61ccc" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a></a>red_loss_epoch <span class="op">/</span> n_total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>tensor(0.7850)</code></pre>
</div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Compute the average accuracy of the model on the validation set</label></li>
</ul>
<div id="017c054d" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a></a>val_acc_metric.compute()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>tensor(0.7378)</code></pre>
</div>
</div>
</section>
<section id="wrap-the-training-and-validation-steps-for-multiple-epochs" class="slide level2 scrollable">
<h2>Wrap the training and validation steps for multiple epochs</h2>
<p>Track the performance of the model throughout the epochs during training</p>
<ul class="task-list">
<li><label><input type="checkbox">Copy the training and validation steps into an epochs loop</label></li>
</ul>
<div id="25990d4d" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a></a>avg_cls_loss_trn <span class="op">=</span> []</span>
<span id="cb79-2"><a></a>avg_red_loss_trn <span class="op">=</span> []</span>
<span id="cb79-3"><a></a>avg_acc_trn <span class="op">=</span> []</span>
<span id="cb79-4"><a></a></span>
<span id="cb79-5"><a></a>avg_cls_loss_val <span class="op">=</span> []</span>
<span id="cb79-6"><a></a>avg_red_loss_val <span class="op">=</span> []</span>
<span id="cb79-7"><a></a>avg_acc_val <span class="op">=</span> []</span>
<span id="cb79-8"><a></a></span>
<span id="cb79-9"><a></a>n_epochs <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb79-10"><a></a>q <span class="op">=</span> tqdm(total<span class="op">=</span>n_epochs)</span>
<span id="cb79-11"><a></a></span>
<span id="cb79-12"><a></a><span class="cf">for</span> e <span class="kw">in</span> <span class="bu">range</span>(n_epochs):</span>
<span id="cb79-13"><a></a>    <span class="co"># Training loop</span></span>
<span id="cb79-14"><a></a>    classifier.train()</span>
<span id="cb79-15"><a></a></span>
<span id="cb79-16"><a></a>    loss_epoch <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb79-17"><a></a></span>
<span id="cb79-18"><a></a>    trn_acc_metric.reset()</span>
<span id="cb79-19"><a></a>    </span>
<span id="cb79-20"><a></a>    total_samples <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb79-21"><a></a>    <span class="cf">for</span> x, y, fx <span class="kw">in</span> trn_feat_dl:</span>
<span id="cb79-22"><a></a>        optimizer.zero_grad()</span>
<span id="cb79-23"><a></a></span>
<span id="cb79-24"><a></a>        <span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb79-25"><a></a>            x <span class="op">=</span> x.cuda()</span>
<span id="cb79-26"><a></a></span>
<span id="cb79-27"><a></a>        y_pred, fx_pred <span class="op">=</span> classifier(x)</span>
<span id="cb79-28"><a></a></span>
<span id="cb79-29"><a></a>        cls_loss <span class="op">=</span> classifier_loss_fn(y_pred.cpu(), y)</span>
<span id="cb79-30"><a></a>        red_loss <span class="op">=</span> reducer_loss_fn(fx_pred.cpu(), fx)</span>
<span id="cb79-31"><a></a></span>
<span id="cb79-32"><a></a>        cls_loss.backward(retain_graph<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb79-33"><a></a>        red_loss.backward()</span>
<span id="cb79-34"><a></a></span>
<span id="cb79-35"><a></a>        optimizer.step()</span>
<span id="cb79-36"><a></a></span>
<span id="cb79-37"><a></a>        cls_loss_epoch <span class="op">+=</span> cls_loss.item() <span class="op">*</span> <span class="bu">len</span>(y)</span>
<span id="cb79-38"><a></a>        red_loss_epoch <span class="op">+=</span> red_loss.item() <span class="op">*</span> <span class="bu">len</span>(y)</span>
<span id="cb79-39"><a></a></span>
<span id="cb79-40"><a></a>        trn_acc_metric(y_pred.cpu().softmax(dim<span class="op">=</span><span class="dv">1</span>), y)</span>
<span id="cb79-41"><a></a>        total_samples <span class="op">+=</span> <span class="bu">len</span>(y)</span>
<span id="cb79-42"><a></a></span>
<span id="cb79-43"><a></a>    avg_cls_loss_trn.append(cls_loss_epoch <span class="op">/</span> total_samples)</span>
<span id="cb79-44"><a></a>    avg_red_loss_trn.append(red_loss_epoch <span class="op">/</span> total_samples)</span>
<span id="cb79-45"><a></a></span>
<span id="cb79-46"><a></a>    avg_acc_trn.append(trn_acc_metric.compute())</span>
<span id="cb79-47"><a></a></span>
<span id="cb79-48"><a></a>    <span class="co"># Validation loop</span></span>
<span id="cb79-49"><a></a>    classifier.<span class="bu">eval</span>()</span>
<span id="cb79-50"><a></a></span>
<span id="cb79-51"><a></a>    cls_loss_epoch <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb79-52"><a></a>    red_loss_epoch <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb79-53"><a></a></span>
<span id="cb79-54"><a></a>    val_acc_metric.reset()</span>
<span id="cb79-55"><a></a></span>
<span id="cb79-56"><a></a>    total_samples <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb79-57"><a></a>    <span class="cf">for</span> x_val, y_val, fx_val <span class="kw">in</span> val_feat_dl:</span>
<span id="cb79-58"><a></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb79-59"><a></a>            <span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb79-60"><a></a>                x_val <span class="op">=</span> x_val.cuda()</span>
<span id="cb79-61"><a></a></span>
<span id="cb79-62"><a></a>            y_val_pred, fx_val_pred <span class="op">=</span> classifier(x_val)</span>
<span id="cb79-63"><a></a></span>
<span id="cb79-64"><a></a>            cls_loss <span class="op">=</span> classifier_loss_fn(y_val_pred.cpu(), y_val)</span>
<span id="cb79-65"><a></a>            red_loss <span class="op">=</span> reducer_loss_fn(fx_val_pred.cpu(), fx_val)</span>
<span id="cb79-66"><a></a></span>
<span id="cb79-67"><a></a>        cls_loss_epoch <span class="op">+=</span> cls_loss.item() <span class="op">*</span> <span class="bu">len</span>(y_val)</span>
<span id="cb79-68"><a></a>        red_loss_epoch <span class="op">+=</span> red_loss.item() <span class="op">*</span> <span class="bu">len</span>(y_val)</span>
<span id="cb79-69"><a></a></span>
<span id="cb79-70"><a></a>        val_acc_metric(y_val_pred.cpu().softmax(dim<span class="op">=</span><span class="dv">1</span>), y_val)</span>
<span id="cb79-71"><a></a>        total_samples <span class="op">+=</span> <span class="bu">len</span>(y_val)</span>
<span id="cb79-72"><a></a></span>
<span id="cb79-73"><a></a>    avg_cls_loss_val.append(cls_loss_epoch <span class="op">/</span> total_samples)</span>
<span id="cb79-74"><a></a>    avg_red_loss_val.append(red_loss_epoch <span class="op">/</span> total_samples)</span>
<span id="cb79-75"><a></a></span>
<span id="cb79-76"><a></a>    avg_acc_val.append(val_acc_metric.compute())</span>
<span id="cb79-77"><a></a></span>
<span id="cb79-78"><a></a>    q.set_description(<span class="ss">f"Average training CE loss: </span><span class="sc">{</span>avg_cls_loss_trn[<span class="op">-</span><span class="dv">1</span>]<span class="sc">:0.4f}</span><span class="ss"> / MSE loss: </span><span class="sc">{</span>avg_red_loss_trn[<span class="op">-</span><span class="dv">1</span>]<span class="sc">:0.4f}</span><span class="ss"> (Accuracy: </span><span class="sc">{</span><span class="dv">100</span> <span class="op">*</span> avg_acc_trn[<span class="op">-</span><span class="dv">1</span>]<span class="sc">:0.2f}</span><span class="ss"> %). Average validation CE loss: </span><span class="sc">{</span>avg_cls_loss_val[<span class="op">-</span><span class="dv">1</span>]<span class="sc">:04f}</span><span class="ss"> / MSE loss: </span><span class="sc">{</span>avg_red_loss_val[<span class="op">-</span><span class="dv">1</span>]<span class="sc">:04f}</span><span class="ss"> (Accuracy: </span><span class="sc">{</span><span class="dv">100</span> <span class="op">*</span> avg_acc_val[<span class="op">-</span><span class="dv">1</span>]<span class="sc">:0.2f}</span><span class="ss"> %)"</span>)</span>
<span id="cb79-79"><a></a>    q.update()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a0c970d23b25472ea913cbcb63a2e0ef","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
</section>
<section id="review-the-performance-of-the-model-throughout-training" class="slide level2 scrollable">
<h2>Review the performance of the model throughout training</h2>
<ul class="task-list">
<li><label><input type="checkbox">Plot the loss function evaluation for the training and validation sets</label></li>
</ul>
<div id="cf603c67" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a></a>plt.plot(avg_cls_loss_trn, <span class="st">"k-"</span>, label<span class="op">=</span><span class="st">"Training loss"</span>)</span>
<span id="cb80-2"><a></a>plt.plot(avg_cls_loss_val, <span class="st">"b:"</span>, label<span class="op">=</span><span class="st">"Validation loss"</span>)</span>
<span id="cb80-3"><a></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="DL_image_analysis_2_files/figure-revealjs/cell-64-output-1.png" width="794" height="411"></p>
</figure>
</div>
</div>
</div>
<div id="b7f9c7fb" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a></a>plt.plot(avg_red_loss_trn, <span class="st">"k-"</span>, label<span class="op">=</span><span class="st">"Training loss"</span>)</span>
<span id="cb81-2"><a></a>plt.plot(avg_red_loss_val, <span class="st">"b:"</span>, label<span class="op">=</span><span class="st">"Validation loss"</span>)</span>
<span id="cb81-3"><a></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="DL_image_analysis_2_files/figure-revealjs/cell-65-output-1.png" width="789" height="411"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="review-the-performance-of-the-model-throughout-training-1" class="slide level2 scrollable">
<h2>Review the performance of the model throughout training</h2>
<ul class="task-list">
<li><label><input type="checkbox">Plot the accuracy of the model on the training and validation sets</label></li>
</ul>
<div id="3e5d5708" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a></a>plt.plot(avg_acc_trn, <span class="st">"k-"</span>, label<span class="op">=</span><span class="st">"Training accuracy"</span>)</span>
<span id="cb82-2"><a></a>plt.plot(avg_acc_val, <span class="st">"b:"</span>, label<span class="op">=</span><span class="st">"Validation accuracy"</span>)</span>
<span id="cb82-3"><a></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="DL_image_analysis_2_files/figure-revealjs/cell-66-output-1.png" width="802" height="411"></p>
</figure>
</div>
</div>
</div>
</section></section>
<section>
<section id="evaluate-the-model-with-the-witheld-testing-data" class="title-slide slide level1 center">
<h1>Evaluate the model with the witheld testing data</h1>

</section>
<section id="save-the-classifier-model-to-be-used-later-or-shared-with-collaborators" class="slide level2 scrollable">
<h2>Save the classifier model to be used later or shared with collaborators</h2>
<ul class="task-list">
<li><label><input type="checkbox">Evaluate the classifier on the testing set to measure its generalization capacity</label></li>
</ul>
<div id="0ac523d8" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a></a><span class="im">from</span> torchmetrics.classification <span class="im">import</span> ConfusionMatrix</span>
<span id="cb83-2"><a></a></span>
<span id="cb83-3"><a></a>classifier.<span class="bu">eval</span>()</span>
<span id="cb83-4"><a></a></span>
<span id="cb83-5"><a></a>n_dmso <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb83-6"><a></a>n_crispr <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb83-7"><a></a>n_orf <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb83-8"><a></a></span>
<span id="cb83-9"><a></a>cls_loss_epoch <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb83-10"><a></a>red_loss_epoch <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb83-11"><a></a></span>
<span id="cb83-12"><a></a>tst_acc_metric <span class="op">=</span> Accuracy(<span class="st">"multiclass"</span>, num_classes<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb83-13"><a></a>tst_confmat <span class="op">=</span> ConfusionMatrix(<span class="st">"multiclass"</span>, num_classes<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb83-14"><a></a></span>
<span id="cb83-15"><a></a><span class="cf">for</span> x_tst, y_tst, fx_tst <span class="kw">in</span> tst_feat_dl:</span>
<span id="cb83-16"><a></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb83-17"><a></a>        <span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb83-18"><a></a>            x_tst <span class="op">=</span> x_tst.cuda()</span>
<span id="cb83-19"><a></a></span>
<span id="cb83-20"><a></a>        y_tst_pred, fx_tst_pred <span class="op">=</span> classifier(x_tst)</span>
<span id="cb83-21"><a></a>        cls_loss <span class="op">=</span> classifier_loss_fn(y_tst_pred.cpu(), y_tst)</span>
<span id="cb83-22"><a></a>        red_loss <span class="op">=</span> reducer_loss_fn(fx_tst_pred.cpu(), fx_tst)</span>
<span id="cb83-23"><a></a></span>
<span id="cb83-24"><a></a>    cls_loss_epoch <span class="op">+=</span> cls_loss.item() <span class="op">*</span> <span class="bu">len</span>(y_tst)</span>
<span id="cb83-25"><a></a>    red_loss_epoch <span class="op">+=</span> red_loss.item() <span class="op">*</span> <span class="bu">len</span>(y_tst)</span>
<span id="cb83-26"><a></a>    </span>
<span id="cb83-27"><a></a>    y_tst_prob <span class="op">=</span> y_tst_pred.cpu().softmax(dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb83-28"><a></a>    tst_acc_metric.update(y_tst_prob, y_tst)</span>
<span id="cb83-29"><a></a>    tst_confmat.update(y_tst_prob, y_tst)</span>
<span id="cb83-30"><a></a></span>
<span id="cb83-31"><a></a>    n_dmso <span class="op">+=</span> <span class="bu">sum</span>(y_tst <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb83-32"><a></a>    n_crispr <span class="op">+=</span> <span class="bu">sum</span>(y_tst <span class="op">==</span> <span class="dv">1</span>)</span>
<span id="cb83-33"><a></a>    n_orf <span class="op">+=</span> <span class="bu">sum</span>(y_tst <span class="op">==</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="save-the-classifier-model-to-be-used-later-or-shared-with-collaborators-1" class="slide level2 scrollable">
<h2>Save the classifier model to be used later or shared with collaborators</h2>
<ul class="task-list">
<li><label><input type="checkbox">Check the proportion of types of perturbation in the testing set</label></li>
</ul>
<div id="1b779271" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a></a>n_total <span class="op">=</span> n_dmso <span class="op">+</span> n_crispr <span class="op">+</span> n_orf</span>
<span id="cb84-2"><a></a>n_dmso <span class="op">/</span> n_total, n_crispr <span class="op">/</span> n_total, n_orf <span class="op">/</span> n_total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>(tensor(0.0240), tensor(0.2986), tensor(0.6774))</code></pre>
</div>
</div>
<ul class="task-list">
<li><label><input type="checkbox">Check the loss metrics on the testing set</label></li>
</ul>
<div id="01adee14" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a></a>cls_loss_epoch <span class="op">/</span> n_total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>tensor(0.1779)</code></pre>
</div>
</div>
<div id="2f978740" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a></a>red_loss_epoch <span class="op">/</span> n_total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>tensor(2.5287)</code></pre>
</div>
</div>
</section>
<section id="save-the-classifier-model-to-be-used-later-or-shared-with-collaborators-2" class="slide level2 scrollable">
<h2>Save the classifier model to be used later or shared with collaborators</h2>
<ul class="task-list">
<li><label><input type="checkbox">Check the accuracy metrics on the testing set</label></li>
</ul>
<div id="7d0673a8" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a></a>tst_acc_metric.compute()</span>
<span id="cb90-2"><a></a>tst_confmat.compute()</span>
<span id="cb90-3"><a></a>tst_confmat.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>(&lt;Figure size 640x480 with 1 Axes&gt;,
 &lt;Axes: xlabel='Predicted class', ylabel='True class'&gt;)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="DL_image_analysis_2_files/figure-revealjs/cell-71-output-2.png" width="489" height="491"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="evaluate-the-capacity-to-mimic-the-umap-dimensionality-reduction" class="slide level2 scrollable">
<h2>Evaluate the capacity to mimic the UMap dimensionality reduction</h2>
<ul class="task-list">
<li><label><input type="checkbox">Get the embeddings from the trained model for the training set</label></li>
</ul>
<div id="2fff73ff" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a></a>trn_fx <span class="op">=</span> []</span>
<span id="cb92-2"><a></a>trn_fx_pred <span class="op">=</span> []</span>
<span id="cb92-3"><a></a>trn_y <span class="op">=</span> []</span>
<span id="cb92-4"><a></a></span>
<span id="cb92-5"><a></a><span class="cf">for</span> i, (x, y, fx) <span class="kw">in</span> <span class="bu">enumerate</span>(trn_feat_dl):</span>
<span id="cb92-6"><a></a>    <span class="cf">if</span> i <span class="op">&gt;=</span> <span class="dv">10</span>:</span>
<span id="cb92-7"><a></a>        <span class="cf">break</span></span>
<span id="cb92-8"><a></a></span>
<span id="cb92-9"><a></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb92-10"><a></a>        <span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb92-11"><a></a>            x <span class="op">=</span> x.cuda()</span>
<span id="cb92-12"><a></a></span>
<span id="cb92-13"><a></a>        _, fx_pred <span class="op">=</span> classifier(x)</span>
<span id="cb92-14"><a></a>        trn_fx_pred.append(fx_pred.detach().cpu())</span>
<span id="cb92-15"><a></a>        trn_fx.append(fx)</span>
<span id="cb92-16"><a></a>        trn_y.append(y)</span>
<span id="cb92-17"><a></a></span>
<span id="cb92-18"><a></a>trn_fx <span class="op">=</span> torch.cat(trn_fx, dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb92-19"><a></a>trn_fx_pred <span class="op">=</span> torch.cat(trn_fx_pred, dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb92-20"><a></a>trn_y <span class="op">=</span> torch.cat(trn_y, dim<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="evaluate-the-capacity-to-mimic-the-umap-dimensionality-reduction-1" class="slide level2 scrollable">
<h2>Evaluate the capacity to mimic the UMap dimensionality reduction</h2>
<ul class="task-list">
<li><label><input type="checkbox">Compate the embedding spaces (UMap vs learned) with the training set</label></li>
</ul>
<div id="7c142461" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a></a><span class="cf">for</span> class_idx, class_name <span class="kw">in</span> <span class="bu">enumerate</span>(class_names):</span>
<span id="cb93-2"><a></a>    plt.scatter(trn_fx[trn_y <span class="op">==</span> class_idx, <span class="dv">0</span>], trn_fx[trn_y <span class="op">==</span> class_idx, <span class="dv">1</span>], label<span class="op">=</span>class_names[class_idx], marker<span class="op">=</span>class_markers[class_idx], facecolors<span class="op">=</span>class_facecolors[class_idx], edgecolors<span class="op">=</span>class_colors[class_idx])</span>
<span id="cb93-3"><a></a></span>
<span id="cb93-4"><a></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="DL_image_analysis_2_files/figure-revealjs/cell-73-output-1.png" width="789" height="411"></p>
</figure>
</div>
</div>
</div>
<div id="cf6b99d3" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a></a><span class="cf">for</span> class_idx, class_name <span class="kw">in</span> <span class="bu">enumerate</span>(class_names):</span>
<span id="cb94-2"><a></a>    plt.scatter(trn_fx_pred[trn_y <span class="op">==</span> class_idx, <span class="dv">0</span>], trn_fx_pred[trn_y <span class="op">==</span> class_idx, <span class="dv">1</span>], label<span class="op">=</span>class_names[class_idx], marker<span class="op">=</span>class_markers[class_idx], facecolors<span class="op">=</span>class_facecolors[class_idx], edgecolors<span class="op">=</span>class_colors[class_idx])</span>
<span id="cb94-3"><a></a></span>
<span id="cb94-4"><a></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="DL_image_analysis_2_files/figure-revealjs/cell-74-output-1.png" width="805" height="415"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="evaluate-the-capacity-to-mimic-the-umap-dimensionality-reduction-2" class="slide level2 scrollable">
<h2>Evaluate the capacity to mimic the UMap dimensionality reduction</h2>
<ul class="task-list">
<li><label><input type="checkbox">Get the embeddings from the trained model for the validation set</label></li>
</ul>
<div id="8f217298" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a></a>val_fx <span class="op">=</span> []</span>
<span id="cb95-2"><a></a>val_fx_pred <span class="op">=</span> []</span>
<span id="cb95-3"><a></a>val_y <span class="op">=</span> []</span>
<span id="cb95-4"><a></a></span>
<span id="cb95-5"><a></a><span class="cf">for</span> i, (x_val, y_val, fx_val) <span class="kw">in</span> <span class="bu">enumerate</span>(val_feat_dl):</span>
<span id="cb95-6"><a></a>    <span class="cf">if</span> i <span class="op">&gt;=</span> <span class="dv">10</span>:</span>
<span id="cb95-7"><a></a>        <span class="cf">break</span></span>
<span id="cb95-8"><a></a></span>
<span id="cb95-9"><a></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb95-10"><a></a>        <span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb95-11"><a></a>            x_val <span class="op">=</span> x_val.cuda()</span>
<span id="cb95-12"><a></a></span>
<span id="cb95-13"><a></a>        _, fx_pred_val <span class="op">=</span> classifier(x_val)</span>
<span id="cb95-14"><a></a>        val_fx_pred.append(fx_pred_val.detach().cpu())</span>
<span id="cb95-15"><a></a>        val_fx.append(fx_val)</span>
<span id="cb95-16"><a></a>        val_y.append(y_val)</span>
<span id="cb95-17"><a></a></span>
<span id="cb95-18"><a></a>val_fx <span class="op">=</span> torch.cat(val_fx, dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb95-19"><a></a>val_fx_pred <span class="op">=</span> torch.cat(val_fx_pred, dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb95-20"><a></a>val_y <span class="op">=</span> torch.cat(val_y, dim<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="evaluate-the-capacity-to-mimic-the-umap-dimensionality-reduction-3" class="slide level2 scrollable">
<h2>Evaluate the capacity to mimic the UMap dimensionality reduction</h2>
<ul class="task-list">
<li><label><input type="checkbox">Compate the embedding spaces (UMap vs learned) with the validation set</label></li>
</ul>
<div id="02c8dade" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a></a><span class="cf">for</span> class_idx, class_name <span class="kw">in</span> <span class="bu">enumerate</span>(class_names):</span>
<span id="cb96-2"><a></a>    plt.scatter(val_fx[val_y <span class="op">==</span> class_idx, <span class="dv">0</span>], val_fx[val_y <span class="op">==</span> class_idx, <span class="dv">1</span>], label<span class="op">=</span>class_names[class_idx], marker<span class="op">=</span>class_markers[class_idx], facecolors<span class="op">=</span>class_facecolors[class_idx], edgecolors<span class="op">=</span>class_colors[class_idx])</span>
<span id="cb96-3"><a></a></span>
<span id="cb96-4"><a></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="DL_image_analysis_2_files/figure-revealjs/cell-76-output-1.png" width="789" height="411"></p>
</figure>
</div>
</div>
</div>
<div id="f748c62d" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a></a><span class="cf">for</span> class_idx, class_name <span class="kw">in</span> <span class="bu">enumerate</span>(class_names):</span>
<span id="cb97-2"><a></a>    plt.scatter(val_fx_pred[val_y <span class="op">==</span> class_idx, <span class="dv">0</span>], val_fx_pred[val_y <span class="op">==</span> class_idx, <span class="dv">1</span>], label<span class="op">=</span>class_names[class_idx], marker<span class="op">=</span>class_markers[class_idx], facecolors<span class="op">=</span>class_facecolors[class_idx], edgecolors<span class="op">=</span>class_colors[class_idx])</span>
<span id="cb97-3"><a></a></span>
<span id="cb97-4"><a></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="DL_image_analysis_2_files/figure-revealjs/cell-77-output-1.png" width="789" height="411"></p>
</figure>
</div>
</div>
</div>
</section></section>
<section>
<section id="use-the-pre-trained-model-to-identify-the-behavior-of-compounds" class="title-slide slide level1 center">
<h1>Use the pre-trained model to identify the behavior of compounds</h1>
<p>Because the model has learned to recognize <em>CRISPR</em>, <em>ORF</em>, and <em>NONE/DMSO</em> effects, it can be used to determine the behavior of any treatment based on their morphological profile.</p>
<p>To do so, first extract the the morphological features using the pre-trained <em>MobileNet</em>, and then use the extracted features as input for the classifier model.</p>
</section>
<section id="execute-the-feature-extraction-and-classification-pipeline-for-compound-data" class="slide level2 scrollable">
<h2>Execute the feature extraction and classification pipeline for <em>compound</em> data</h2>
<div id="4100a7b2" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a></a>compounds_ds <span class="op">=</span> TiffS3Dataset(comp_plate_maps, wells_metadata, comp_plate_maps[<span class="st">"Plate_name"</span>].tolist(), <span class="dv">16</span>, <span class="dv">24</span>, <span class="dv">9</span>, <span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb98-2"><a></a></span>
<span id="cb98-3"><a></a>batch_size <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb98-4"><a></a></span>
<span id="cb98-5"><a></a>compounds_dl <span class="op">=</span> DataLoader(compounds_ds, batch_size<span class="op">=</span>batch_size, num_workers<span class="op">=</span><span class="dv">2</span>, worker_init_fn<span class="op">=</span>dataset_worker_init_fn)</span>
<span id="cb98-6"><a></a></span>
<span id="cb98-7"><a></a>metadata_list <span class="op">=</span> []</span>
<span id="cb98-8"><a></a><span class="cf">for</span> i, (x, y, metadata) <span class="kw">in</span> tqdm(<span class="bu">enumerate</span>(compounds_dl)):</span>
<span id="cb98-9"><a></a>    metadata_list.append(metadata)</span>
<span id="cb98-10"><a></a></span>
<span id="cb98-11"><a></a>    b, c, h, w <span class="op">=</span> x.shape</span>
<span id="cb98-12"><a></a>    x_t <span class="op">=</span> model_transforms(torch.tile(x.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, h, w), (<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>)))</span>
<span id="cb98-13"><a></a></span>
<span id="cb98-14"><a></a>    <span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb98-15"><a></a>        x_t <span class="op">=</span> x_t.cuda()</span>
<span id="cb98-16"><a></a></span>
<span id="cb98-17"><a></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb98-18"><a></a>        x_out <span class="op">=</span> model(x_t)</span>
<span id="cb98-19"><a></a>        x_out <span class="op">=</span> x_out.detach().reshape(<span class="op">-</span><span class="dv">1</span>, c, <span class="dv">576</span>, <span class="dv">7</span>, <span class="dv">7</span>).<span class="bu">sum</span>(dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb98-20"><a></a>        x_out <span class="op">=</span> org_avgpool(x_out).detach().reshape(b, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb98-21"><a></a></span>
<span id="cb98-22"><a></a>        y_pred, fx_pred <span class="op">=</span> classifier(x_out)</span>
<span id="cb98-23"><a></a></span>
<span id="cb98-24"><a></a>    <span class="cf">break</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7fc648107a9241199dc4b20c43de6fa5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
</section>
<section id="execute-the-feature-extraction-and-classification-pipeline-for-compound-data-1" class="slide level2 scrollable">
<h2>Execute the feature extraction and classification pipeline for <em>compound</em> data</h2>
<ul class="task-list">
<li><label><input type="checkbox">Plot the embeddings of the compound samples</label></li>
</ul>
<div id="dce1a5b4" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a></a><span class="cf">for</span> class_idx, class_name <span class="kw">in</span> <span class="bu">enumerate</span>(class_names[:<span class="dv">3</span>]):</span>
<span id="cb99-2"><a></a>    plt.scatter(trn_fx_pred[trn_y <span class="op">==</span> class_idx, <span class="dv">0</span>][::<span class="dv">10</span>], trn_fx_pred[trn_y <span class="op">==</span> class_idx, <span class="dv">1</span>][::<span class="dv">10</span>], label<span class="op">=</span>class_names[class_idx], marker<span class="op">=</span>class_markers[class_idx], facecolors<span class="op">=</span>class_facecolors[class_idx], edgecolors<span class="op">=</span>class_colors[class_idx])</span>
<span id="cb99-3"><a></a></span>
<span id="cb99-4"><a></a>plt.scatter(fx_pred.cpu()[:, <span class="dv">0</span>], fx_pred.cpu()[:, <span class="dv">1</span>], label<span class="op">=</span>class_names[<span class="dv">3</span>], marker<span class="op">=</span>class_markers[<span class="dv">3</span>], facecolors<span class="op">=</span>class_facecolors[<span class="dv">3</span>], edgecolors<span class="op">=</span>class_colors[<span class="dv">3</span>])</span>
<span id="cb99-5"><a></a></span>
<span id="cb99-6"><a></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="DL_image_analysis_2_files/figure-revealjs/cell-79-output-1.png" width="789" height="411"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="execute-the-feature-extraction-and-classification-pipeline-for-compound-data-2" class="slide level2 scrollable">
<h2>Execute the feature extraction and classification pipeline for <em>compound</em> data</h2>
<ul class="task-list">
<li><label><input type="checkbox">Look for any interesting compounds in <a href="https://pubchem.ncbi.nlm.nih.gov/">PubChem</a></label></li>
</ul>
<div id="32bbd383" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a></a>metadata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>{'Plate_name': ['Dest210727-153623',
  'PEP00004070',
  '110000294885',
  'P09_APTJUM419',
  '1086290323'],
 'Source_name': ['source_10', 'source_15', 'source_6', 'source_5', 'source_2'],
 'Batch_name': ['2021_08_09_U2OS_48_hr_run13',
  '2021_12_17_Batch1',
  'p210906CPU2OS48hw384exp025JUMP',
  'JUMPCPE-20210902-Run26_20210903_010341',
  '20210920_Batch_12'],
 'Plate_type': ['COMPOUND', 'COMPOUND', 'COMPOUND', 'COMPOUND', 'COMPOUND'],
 'Plate_path': ['Dest210727-153623',
  'PEP00004070__2021-12-14T07_25_04-Measurement2',
  '110000294885',
  'P09_APTJUM419',
  '1086290323'],
 'Well_position': ['M17', 'I02', 'P11', 'B16', 'A04']}</code></pre>
</div>
</div>
<div id="edbf3bbe" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a></a>y_pred.argmax(dim<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>tensor([2, 1, 1, 1, 2], device='cuda:0')</code></pre>
</div>
</div>
<div id="a5449435" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a></a>wells_metadata.query(<span class="st">"well_position == 'H13' &amp; Plate_type=='COMPOUND'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">

  <div id="df-dc11e622-f20b-4dd4-8d0d-6876f7f3ac3b" class="colab-df-container">
    <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">well_position</th>
<th data-quarto-table-cell-role="th">broad_sample</th>
<th data-quarto-table-cell-role="th">solvent</th>
<th data-quarto-table-cell-role="th">Plate_type</th>
<th data-quarto-table-cell-role="th">Plate_label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">180</td>
<td>H13</td>
<td>NaN</td>
<td>DMSO</td>
<td>COMPOUND</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">
      
  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-dc11e622-f20b-4dd4-8d0d-6876f7f3ac3b')" title="Convert this dataframe to an interactive table." style="display:none;">
      
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>
    
  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-dc11e622-f20b-4dd4-8d0d-6876f7f3ac3b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-dc11e622-f20b-4dd4-8d0d-6876f7f3ac3b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>
  
    </div>
  </div>
  
</div>
</div>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script type="application/vnd.jupyter.widget-state+json">
    {"state":{"00f2631e8e1e4ac9ad6bbedfcfeae912":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"03aa4ad2e092498294378289e13e16eb":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"15dd0a4cf02d46b2b2af028f5c480d1e":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"danger","description":"","description_tooltip":null,"layout":"IPY_MODEL_38287aae64af4c8f8a0f048994c0d3e0","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_fd2a227b73f74cad91062ac1ba7d8385","value":0}},"1ee80fb4ec2b47469e664f102a06f67d":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"27f686ab5d2a46d69c508a25ef056ebb":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f62ff85ae07f4c7689a9d5f69e03c94c","placeholder":"â€‹","style":"IPY_MODEL_7aa516bd27fb4e58bc8c4fa5b14f117f","value":""}},"2857f8cf03024f1ca602111380795102":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"2aa77c0c8615465f97211a7bee7340a5":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_03aa4ad2e092498294378289e13e16eb","placeholder":"â€‹","style":"IPY_MODEL_707651e3cff144819a7dba3aec7d6a78","value":""}},"2aada74911994c48bf6c294cb878c41a":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_eb13f26793c5444c852c05d1c399b07e","placeholder":"â€‹","style":"IPY_MODEL_fff547895ad044bf9f85714eb60eba2a","value":"Averageâ€‡trainingâ€‡CEâ€‡loss:â€‡0.2933â€‡/â€‡MSEâ€‡loss:â€‡2.2314â€‡(Accuracy:â€‡88.47â€‡%).â€‡Averageâ€‡validationâ€‡CEâ€‡loss:â€‡0.167311â€‡/â€‡MSEâ€‡loss:â€‡2.018440â€‡(Accuracy:â€‡97.52â€‡%):â€‡100%"}},"2cc202ee10ca4d1c94fc73bb8d97e6e3":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ae07ec0d12bc445d80c4d11dedb6ce33","placeholder":"â€‹","style":"IPY_MODEL_ed66a64c8c914b8ea0299bbbaf0b7c34","value":""}},"3006009bd09c48aeac5df860e318f532":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"310373bfdbcc4532988ba9fe1de13673":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"38287aae64af4c8f8a0f048994c0d3e0":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"39d4d33ae8504942834ce52115ef9288":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3c04ce6140cf461d981ff35a0c15c10d":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"3c5d781ddcf546c1ae5d93436cc41fb9":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"418b7711bb824fbc95edc8e89eddc7fe":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"425b3a37bcb04d5daffa8a8ffbf7da18":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_310373bfdbcc4532988ba9fe1de13673","placeholder":"â€‹","style":"IPY_MODEL_6e3a1b402197488790839760d24e668a","value":"â€‡0/?â€‡[00:11&lt;?,â€‡?it/s]"}},"42d38c0df4e14dcd9ae02c7a414d0cf9":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"479d0a84a8af4f37bf1c07ca36532238":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"484a4637bc704df6847d71f4776810f8":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a1d30a5ad64c45708a90e4bd93bbab75","IPY_MODEL_bc89b106956d412790cb01861982c08e","IPY_MODEL_a2aa7fd8de89417a962d0918fe5b1639"],"layout":"IPY_MODEL_c3cfb2d175364032b76d22d47f7ff209"}},"4aa8270448dc4f79a86457e3a6e86549":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"56b1ce94b5704fe6914b3ef7ba549d91":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"danger","description":"","description_tooltip":null,"layout":"IPY_MODEL_3006009bd09c48aeac5df860e318f532","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8f57d1ca9de645a29d2eb72c23564c57","value":0}},"5cea059d4079400f8cd1102b56a94470":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"64e86a9732a642e481aa5cb1c4ef6315":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"67ba215e21a34573968a95a0f18c8d26":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_ffef508878174f4eabcf27a1b641cc96","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_00f2631e8e1e4ac9ad6bbedfcfeae912","value":1}},"6db222231561430e915d1ad9ebbf2611":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"6e3a1b402197488790839760d24e668a":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"707651e3cff144819a7dba3aec7d6a78":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"72dbb6eac51e47b49d7507a5960cae50":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"75173e976429477a963b6beda40c5bd0":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7aa516bd27fb4e58bc8c4fa5b14f117f":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7f3e03b7f7dc40cabff1e2d95c555ea6":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7fc648107a9241199dc4b20c43de6fa5":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2aa77c0c8615465f97211a7bee7340a5","IPY_MODEL_c8610cb529124c90b768708245f644d4","IPY_MODEL_84e95266b70141209306026559779a28"],"layout":"IPY_MODEL_418b7711bb824fbc95edc8e89eddc7fe"}},"84e95266b70141209306026559779a28":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f3b81522a4ba4fa4a9d45ebe4f9b4ae9","placeholder":"â€‹","style":"IPY_MODEL_9ef777e29ae74a24a05a95e57cd030b7","value":"â€‡0/?â€‡[00:05&lt;?,â€‡?it/s]"}},"86bb6c010d4d43efa7655e8c3bc6b635":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_dfe98b1dd94a43d18152950b2968a93b","placeholder":"â€‹","style":"IPY_MODEL_a2f988dbd17f4d86a46be95901b329c9","value":"â€‡0/?â€‡[00:11&lt;?,â€‡?it/s]"}},"8baf3a17f70d46088a9852c32d20b86f":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f79fbbed24c54c8eb5f68ac356523372","IPY_MODEL_67ba215e21a34573968a95a0f18c8d26","IPY_MODEL_da2d6cb758fd4db184659028b627e159"],"layout":"IPY_MODEL_5cea059d4079400f8cd1102b56a94470"}},"8c4d6f9530904d18beb0c350ae4232b8":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8e6ea7413f844b23bbf32ca41987608b":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8f57d1ca9de645a29d2eb72c23564c57":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"9456a7c38b1b46a4893ebad187639aee":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9ef777e29ae74a24a05a95e57cd030b7":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9fa97a9ef4bd415da7cbe7dcabe9500d":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_e8fc06183e534c7692fe79d0ef3bb184","max":1000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4aa8270448dc4f79a86457e3a6e86549","value":1000}},"a0c970d23b25472ea913cbcb63a2e0ef":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2aada74911994c48bf6c294cb878c41a","IPY_MODEL_f8202fbbdef14c7a8def6486c6177ad0","IPY_MODEL_ecd159f611ec4b30bb22cd876d97c674"],"layout":"IPY_MODEL_479d0a84a8af4f37bf1c07ca36532238"}},"a1d30a5ad64c45708a90e4bd93bbab75":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_42d38c0df4e14dcd9ae02c7a414d0cf9","placeholder":"â€‹","style":"IPY_MODEL_7f3e03b7f7dc40cabff1e2d95c555ea6","value":""}},"a2aa7fd8de89417a962d0918fe5b1639":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f1a307cb2b244798be9ba8e3d42450be","placeholder":"â€‹","style":"IPY_MODEL_fe408b167dd046b2b0abbf9ce0942297","value":"â€‡0/?â€‡[00:11&lt;?,â€‡?it/s]"}},"a2f988dbd17f4d86a46be95901b329c9":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a37860b7a6224ca597ec1d4089b962df":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_75173e976429477a963b6beda40c5bd0","placeholder":"â€‹","style":"IPY_MODEL_1ee80fb4ec2b47469e664f102a06f67d","value":"100%"}},"a468cbb7627245bc89d8f245fd977083":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a548203dfb2d495680fbdef26b0debf7":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_27f686ab5d2a46d69c508a25ef056ebb","IPY_MODEL_15dd0a4cf02d46b2b2af028f5c480d1e","IPY_MODEL_425b3a37bcb04d5daffa8a8ffbf7da18"],"layout":"IPY_MODEL_72dbb6eac51e47b49d7507a5960cae50"}},"ae07ec0d12bc445d80c4d11dedb6ce33":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bc89b106956d412790cb01861982c08e":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"danger","description":"","description_tooltip":null,"layout":"IPY_MODEL_2857f8cf03024f1ca602111380795102","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d270cbed75f84e5187f8e9f43a7a8385","value":0}},"c34a7f34c29f4c44ac5ab31b08362ec9":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c3cfb2d175364032b76d22d47f7ff209":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c8610cb529124c90b768708245f644d4":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"danger","description":"","description_tooltip":null,"layout":"IPY_MODEL_64e86a9732a642e481aa5cb1c4ef6315","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6db222231561430e915d1ad9ebbf2611","value":0}},"caf030333e4b4b7b91a5a2b076214964":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ced82da163cc451a86315db121d9d9bd":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a37860b7a6224ca597ec1d4089b962df","IPY_MODEL_9fa97a9ef4bd415da7cbe7dcabe9500d","IPY_MODEL_e56c375fda4a49bc91f14d72cda72c38"],"layout":"IPY_MODEL_9456a7c38b1b46a4893ebad187639aee"}},"d270cbed75f84e5187f8e9f43a7a8385":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"da2d6cb758fd4db184659028b627e159":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e79ea2875c814db986543669e0378182","placeholder":"â€‹","style":"IPY_MODEL_ded639ff38ee41a4be8604e93a8b66e2","value":"â€‡50/?â€‡[00:00&lt;00:00,â€‡50.54it/s]"}},"ded639ff38ee41a4be8604e93a8b66e2":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"dfe98b1dd94a43d18152950b2968a93b":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e1c97e8deab9499ba5820883d20e3f02":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e56c375fda4a49bc91f14d72cda72c38":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_39d4d33ae8504942834ce52115ef9288","placeholder":"â€‹","style":"IPY_MODEL_a468cbb7627245bc89d8f245fd977083","value":"â€‡1000/1000â€‡[00:15&lt;00:00,â€‡146.27it/s]"}},"e79ea2875c814db986543669e0378182":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e8fc06183e534c7692fe79d0ef3bb184":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"eb13f26793c5444c852c05d1c399b07e":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ec950503d0494a66b435854bdceb9056":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2cc202ee10ca4d1c94fc73bb8d97e6e3","IPY_MODEL_56b1ce94b5704fe6914b3ef7ba549d91","IPY_MODEL_86bb6c010d4d43efa7655e8c3bc6b635"],"layout":"IPY_MODEL_e1c97e8deab9499ba5820883d20e3f02"}},"ecd159f611ec4b30bb22cd876d97c674":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c34a7f34c29f4c44ac5ab31b08362ec9","placeholder":"â€‹","style":"IPY_MODEL_3c5d781ddcf546c1ae5d93436cc41fb9","value":"â€‡20/20â€‡[04:40&lt;00:00,â€‡13.98s/it]"}},"ed66a64c8c914b8ea0299bbbaf0b7c34":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f1a307cb2b244798be9ba8e3d42450be":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f3b81522a4ba4fa4a9d45ebe4f9b4ae9":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f62ff85ae07f4c7689a9d5f69e03c94c":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f79fbbed24c54c8eb5f68ac356523372":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8e6ea7413f844b23bbf32ca41987608b","placeholder":"â€‹","style":"IPY_MODEL_caf030333e4b4b7b91a5a2b076214964","value":""}},"f8202fbbdef14c7a8def6486c6177ad0":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_8c4d6f9530904d18beb0c350ae4232b8","max":20,"min":0,"orientation":"horizontal","style":"IPY_MODEL_3c04ce6140cf461d981ff35a0c15c10d","value":20}},"fd2a227b73f74cad91062ac1ba7d8385":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"fe408b167dd046b2b0abbf9ce0942297":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ffef508878174f4eabcf27a1b641cc96":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"fff547895ad044bf9f85714eb60eba2a":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}},"version_major":2,"version_minor":0}
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>